(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{79461:(e,t,r)=>{Promise.resolve().then(r.bind(r,95229))},95229:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>tP});var s=r(95155),a=r(12115),l=r(53904),n=r(85690),i=r(14186),o=r(51976),c=r(96758),d=r(30227),m=r(36870),u=r(60760),x=r(66766);function h(e){let{size:t=60,className:r="",style:a}=e;return(0,s.jsx)("div",{className:"flex items-center justify-center ".concat(r),style:{width:"".concat(t,"px"),height:"".concat(t,"px"),...a},children:(0,s.jsx)(x.default,{src:"/logo.png",alt:"Dotify Logo",width:t,height:t,className:"object-contain",priority:!0})})}var f=r(47924),p=r(54416),g=r(62525);let b="dotify_recent_searches",v=e=>{let{source:t,size:r=16,className:a="",isSelected:l=!0}=e,n=l?"#6b7280":"#d1d5db";switch(t){case"soundcloud":return(0,s.jsx)("svg",{width:r,height:r,viewBox:"0 0 291.319 291.319",fill:"none",className:a,xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{style:{fill:l?"#FF7700":"#6b7280"},d:"M72.83,218.485h18.207V103.832c-6.828,1.93-12.982,5.435-18.207,10.041C72.83,113.874,72.83,218.485,72.83,218.485z M36.415,140.921v77.436l1.174,0.127h17.033v-77.682H37.589C37.589,140.803,36.415,140.921,36.415,140.921z M0,179.63c0,14.102,7.338,26.328,18.207,33.147V146.52C7.338,153.329,0,165.556,0,179.63z M109.245,218.485h18.207v-109.6c-5.444-3.396-11.607-5.635-18.207-6.5V218.485z M253.73,140.803h-10.242c0.519-3.168,0.847-6.382,0.847-9.705c0-32.182-25.245-58.264-56.388-58.264c-16.896,0-31.954,7.775-42.287,19.955v125.695h108.07c20.747,0,37.589-17.388,37.589-38.855C291.319,158.182,274.477,140.803,253.73,140.803z"})});case"spotify":return(0,s.jsx)("svg",{width:r,height:r,viewBox:"0 0 168 168",fill:"none",className:a,xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{fill:l?"#1ED760":"#6b7280",d:"m83.996 0.277c-46.249 0-83.743 37.493-83.743 83.742 0 46.251 37.494 83.741 83.743 83.741 46.254 0 83.744-37.49 83.744-83.741 0-46.246-37.49-83.738-83.745-83.738l0.001-0.004zm38.404 120.78c-1.5 2.46-4.72 3.24-7.18 1.73-19.662-12.01-44.414-14.73-73.564-8.07-2.809 0.64-5.609-1.12-6.249-3.93-0.643-2.81 1.11-5.61 3.926-6.25 31.9-7.291 59.263-4.15 81.337 9.34 2.46 1.51 3.24 4.72 1.73 7.18zm10.25-22.805c-1.89 3.075-5.91 4.045-8.98 2.155-22.51-13.839-56.823-17.846-83.448-9.764-3.453 1.043-7.1-0.903-8.148-4.35-1.04-3.453 0.907-7.093 4.354-8.143 30.413-9.228 68.222-4.758 94.072 11.127 3.07 1.89 4.04 5.91 2.15 8.976v-0.001zm0.88-23.744c-26.99-16.031-71.52-17.505-97.289-9.684-4.138 1.255-8.514-1.081-9.768-5.219-1.254-4.14 1.08-8.513 5.221-9.771 29.581-8.98 78.756-7.245 109.83 11.202 3.73 2.209 4.95 7.016 2.74 10.733-2.2 3.722-7.02 4.949-10.73 2.739z"})});case"vk":return(0,s.jsxs)("svg",{width:r,height:r,viewBox:"0 0 48 48",fill:"none",className:"h-4 w-4 ".concat(a),xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M0 23.04C0 12.1788 0 6.74826 3.37413 3.37413C6.74826 0 12.1788 0 23.04 0H24.96C35.8212 0 41.2517 0 44.6259 3.37413C48 6.74826 48 12.1788 48 23.04V24.96C48 35.8212 48 41.2517 44.6259 44.6259C41.2517 48 35.8212 48 24.96 48H23.04C12.1788 48 6.74826 48 3.37413 44.6259C0 41.2517 0 35.8212 0 24.96V23.04Z",fill:l?"#0077FF":"#6b7280"}),(0,s.jsx)("path",{d:"M25.54 34.5801C14.6 34.5801 8.3601 27.0801 8.1001 14.6001H13.5801C13.7601 23.7601 17.8 27.6401 21 28.4401V14.6001H26.1602V22.5001C29.3202 22.1601 32.6398 18.5601 33.7598 14.6001H38.9199C38.0599 19.4801 34.4599 23.0801 31.8999 24.5601C34.4599 25.7601 38.5601 28.9001 40.1201 34.5801H34.4399C33.2199 30.7801 30.1802 27.8401 26.1602 27.4401V34.5801H25.54Z",fill:l?"white":"#9ca3af"})]});case"local":return(0,s.jsxs)("svg",{width:r||24,height:r||24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[(0,s.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",stroke:n}),(0,s.jsx)("polyline",{points:"7 10 12 15 17 10",stroke:n}),(0,s.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3",stroke:n})]});case"discord":return(0,s.jsx)("svg",{width:r,height:r,viewBox:"0 0 24 24",fill:"none",className:a,xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09-.01-.02-.04-.03-.07-.03-1.5.26-2.93.71-4.27 1.33-.01 0-.02.01-.03.02-2.72 4.07-3.47 8.03-3.1 11.95 0 .02.01.04.03.05 1.8 1.32 3.53 2.12 5.24 2.65.03.01.06 0 .07-.02.4-.55.76-1.13 1.07-1.74.02-.04 0-.08-.04-.09-.57-.22-1.11-.48-1.64-.78-.04-.02-.04-.08-.01-.11.11-.08.22-.17.33-.25.02-.02.05-.02.07-.01 3.44 1.57 7.15 1.57 10.55 0 .02-.01.05-.01.07.01.11.09.22.17.33.26.04.03.04.09-.01.11-.52.31-1.07.56-1.64-.78-.04.01-.05.06-.04.09.32.61.68 1.19 1.07 1.74.03.02.06.02.09.01 1.72-.53 3.45-1.33 5.25-2.65.02-.01.03-.03.03-.05.44-4.53-.73-8.46-3.1-11.95-.01-.01-.02-.02-.04-.02zM8.52 14.91c-1.03 0-1.89-.95-1.89-2.12 0-1.17.84-2.12 1.89-2.12 1.06 0 1.9.96 1.89 2.12 0 1.17-.84 2.12-1.89 2.12zm6.97 0c-1.03 0-1.89-.95-1.89-2.12 0-1.17.84-2.12 1.89-2.12 1.06 0 1.9.96 1.89 2.12 0 1.17-.83 2.12-1.89 2.12z",fill:l?"#5865F2":"#6b7280"})});case"obs":return(0,s.jsx)("svg",{width:r,height:r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:a,children:(0,s.jsx)("path",{fill:l?"#322f32":"#6b7280",fillRule:"evenodd",d:"M23 12c0 6.075-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1s11 4.925 11 11Zm-3.479 4.326a3.652 3.652 0 0 0-5.23-4.828 3.652 3.652 0 0 0-0.912 5.122 0.466 0.466 0 0 1 0 0.584A5.56 5.56 0 0 1 12 18.391a5.478 5.478 0 0 1-7.213-1.597 3.653 3.653 0 0 0 6.528-2.52 3.652 3.652 0 0 0-3.971-3.36 0.447 0.447 0 0 1-0.494-0.293 5.323 5.323 0 0 1-0.328-1.817 5.478 5.478 0 0 1 5.104-5.478 3.652 3.652 0 1 0 1.954 6.921 3.58 3.58 0 0 0 1.734-1.762 0.474 0.474 0 0 1 0.503-0.283 5.18 5.18 0 0 1 1.661 0.648 5.479 5.479 0 0 1 2.043 7.476Z",clipRule:"evenodd"})});case"all":return(0,s.jsx)("svg",{width:r,height:r,viewBox:"0 0 24 24",fill:"currentColor",className:"text-blue-500 ".concat(a),children:(0,s.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-3.31 0-6 2.69-6 6 0 1.31.42 2.52 1.13 3.5C7.1 13.19 8.48 13 10 13c2.21 0 4 1.79 4 4 0 1.52-.19 2.9-.5 4.13C17.48 20.58 20 16.52 20 12c0-3.31-2.69-6-6-6z"})});default:return(0,s.jsx)("svg",{width:r,height:r,viewBox:"0 0 24 24",fill:"currentColor",className:"text-muted-foreground ".concat(a),children:(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10"})})}};var j=r(37108),y=r(71007),N=r(15273),w=r(51154),k=r(27809),A=r(5765);function C(e){let{title:t="Загрузка...",subtitle:r,className:a,iconClassName:l,variant:n="default",size:o="md"}=e,{icon:c,defaultTitle:u,defaultSubtitle:x}=(()=>{switch(n){case"music":return{icon:d.A,defaultTitle:"Загрузка музыки...",defaultSubtitle:"Получаем треки"};case"search":return{icon:f.A,defaultTitle:"Поиск...",defaultSubtitle:"Ищем результаты"};case"inventory":return{icon:j.A,defaultTitle:"Загрузка инвентаря...",defaultSubtitle:"Получаем предметы"};case"artist":return{icon:y.A,defaultTitle:"Загрузка артиста...",defaultSubtitle:"Получаем информацию"};case"player":return{icon:N.A,defaultTitle:"Подготовка плеера...",defaultSubtitle:"Загружаем аудио"};case"spinner":return{icon:w.A,defaultTitle:t,defaultSubtitle:r};case"shop":return{icon:k.A,defaultTitle:t,defaultSubtitle:r};default:return{icon:i.A,defaultTitle:t,defaultSubtitle:r}}})(),h={sm:{iconSize:"h-8 w-8",titleSize:"text-base",subtitleSize:"text-xs",padding:"p-4"},md:{iconSize:"h-12 w-12",titleSize:"text-lg",subtitleSize:"text-sm",padding:"p-8"},lg:{iconSize:"h-16 w-16",titleSize:"text-xl",subtitleSize:"text-base",padding:"p-10"}}[o],p=(()=>{switch(n){case"spinner":return{animate:{rotate:360},transition:{duration:1,repeat:1/0}};case"pulse":return{animate:{scale:[1,1.2,1],opacity:[.7,1,.7]},transition:{duration:1.5,repeat:1/0}};case"music":return{animate:{rotate:[0,10,-10,0],scale:[1,1.05,1]},transition:{duration:2,repeat:1/0}};case"search":return{animate:{x:[0,2,-2,0],scale:[1,1.1,1]},transition:{duration:1.5,repeat:1/0}};case"shop":return{animate:{y:[0,-8,0],scale:[1,1.1,1],rotate:[0,3,-3,0]},transition:{duration:2,repeat:1/0}};default:return{animate:{rotate:360,scale:[1,1.1,1]},transition:{rotate:{duration:2,repeat:1/0},scale:{duration:1,repeat:1/0}}}}})();return(0,s.jsxs)(m.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,ease:"easeOut"},className:(0,A.cn)("flex flex-col items-center justify-center text-center",h.padding,a),children:[(0,s.jsx)(m.P.div,{className:"mb-4",...p,children:(0,s.jsx)(c,{className:(0,A.cn)(h.iconSize,"text-foreground",l)})}),(0,s.jsx)(m.P.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},className:(0,A.cn)(h.titleSize,"font-semibold text-foreground mb-2"),children:t||u}),(r||x)&&(0,s.jsx)(m.P.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.3},className:(0,A.cn)(h.subtitleSize,"text-gray-400 max-w-sm"),children:r||x}),"dots"===n&&(0,s.jsx)("div",{className:"flex space-x-1 mt-4",children:[0,1,2].map(e=>(0,s.jsx)(m.P.div,{className:"w-2 h-2 bg-white rounded-full",animate:{scale:[1,1.5,1],opacity:[.3,1,.3]},transition:{duration:1,repeat:1/0,delay:.2*e}},e))})]})}var S=r(50589),P=r(14395),z=r(28833);function L(e){let{title:t="Ничего не найдено",subtitle:r="Попробуйте изменить параметры поиска",icon:a,iconClassName:l,className:n,variant:i="default"}=e,u=(()=>{if(a)return a;switch(i){case"music":return d.A;case"favorites":case"liked":return o.A;case"offline":case"local":return S.A;case"playlist":return P.A;case"search":return f.A;case"package":case"inventory":default:return j.A;case"queue":return c.A;case"player":return z.A}})();return(0,s.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:(0,A.cn)("flex flex-col items-center justify-center text-center p-8",n),children:[(0,s.jsxs)(m.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.6,delay:.2,ease:"easeOut",scale:{type:"spring",stiffness:200,damping:20}},className:"mb-4 relative",children:[(0,s.jsx)(m.P.div,{animate:{rotate:[0,5,-5,0],scale:[1,.95,1],opacity:[.7,1,.7]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:(0,s.jsx)(u,{className:(0,A.cn)("h-16 w-16 text-muted-foreground",l)})}),"search"===i&&(0,s.jsx)(s.Fragment,{children:[0,1,2].map(e=>(0,s.jsx)(m.P.div,{animate:{scale:[0,1.5,0],opacity:[.6,0,0]},transition:{duration:2,repeat:1/0,ease:"easeOut",delay:.6*e},className:"absolute inset-0 border-2 border-white/30 rounded-full"},e))})]}),(0,s.jsx)(m.P.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.4},className:"text-lg font-semibold text-foreground mb-2",children:t}),r&&(0,s.jsx)(m.P.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.5},className:"text-sm text-muted-foreground max-w-sm",children:r})]})}let M=[{id:"soundcloud",icon:"soundcloud",name:"SoundCloud"},{id:"spotify",icon:"spotify",name:"Spotify"},{id:"vk",icon:"vk",name:"VK"}];function E(e){let{searchQuery:t,onSearchChange:r,onClear:l,hasResults:n=!1,searchType:o="tracks",onSearchTypeChange:u,platform:x="soundcloud",onPlatformChange:h,isSearching:j=!1}=e,[y,N]=(0,a.useState)(!1),[w,k]=(0,a.useState)(!1),{recentSearches:A,addRecentSearch:C,removeRecentSearch:S,clearRecentSearches:P}=function(){let[e,t]=(0,a.useState)([]);return(0,a.useEffect)(()=>{let e=localStorage.getItem(b);if(e)try{let r=JSON.parse(e);t(Array.isArray(r)?r:[])}catch(e){console.error("Failed to parse recent searches:",e),localStorage.removeItem(b)}},[]),(0,a.useEffect)(()=>{localStorage.setItem(b,JSON.stringify(e))},[e]),{recentSearches:e,addRecentSearch:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tracks";if(!e.trim())return;let s={id:Date.now().toString(),query:e.trim(),timestamp:Date.now(),type:r};t(t=>[s,...t.filter(t=>t.query.toLowerCase()!==e.toLowerCase())].slice(0,10))},removeRecentSearch:e=>{t(t=>t.filter(t=>t.id!==e))},clearRecentSearches:()=>{t([])}}}(),z=e=>{r(e),e.trim()&&C(e,o)},E=e=>{r(e)},T=M.find(e=>e.id===x);return(0,a.useEffect)(()=>{let e=e=>{e.target.closest(".platform-dropdown")||k(!1)};return w&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[w]),(0,s.jsx)("div",{className:"flex flex-col bg-background text-foreground",children:(0,s.jsx)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.3},className:"px-4 transition-all duration-300 ".concat(t||y?"pt-4 pb-4":"flex flex-col items-center justify-center h-screen overflow-hidden"),children:(0,s.jsxs)("div",{className:"w-full max-w-sm md:max-w-lg lg:max-w-2xl mx-auto",children:[!t&&!j&&!y&&(0,s.jsx)(m.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-center mb-6",children:(0,s.jsx)(L,{variant:"search",title:"Начните поиск",subtitle:"Найдите любимую музыку на любой платформе",className:"py-8"})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[h&&(0,s.jsxs)("div",{className:"relative platform-dropdown",children:[(0,s.jsx)("button",{onClick:()=>k(!w),className:"flex items-center justify-center w-12 h-12 md:w-14 md:h-14 bg-background/50 hover:bg-background/70 text-foreground rounded-xl transition-all duration-200 backdrop-blur-md border border-border/30 shadow-lg",children:(0,s.jsx)(v,{source:(null==T?void 0:T.icon)||"soundcloud",className:"w-5 h-5 md:w-6 md:h-6"})}),w&&(0,s.jsx)(m.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute top-full left-0 mt-2 w-full bg-background/90 backdrop-blur-xl border border-border/50 rounded-xl shadow-2xl z-50",children:M.map(e=>(0,s.jsx)("button",{onClick:()=>{h(e.id),k(!1)},className:"w-full flex items-center justify-center p-3 hover:bg-accent transition-colors first:rounded-t-xl last:rounded-b-xl ".concat(x===e.id?"bg-primary/10 text-primary":"text-foreground"),children:(0,s.jsx)(v,{source:e.icon,className:"w-5 h-5"})},e.id))})]}),(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 z-10",children:(0,s.jsx)(f.A,{className:"h-5 w-5 text-muted-foreground"})}),(0,s.jsx)("input",{type:"text",value:t,onChange:e=>z(e.target.value),onFocus:()=>N(!0),onBlur:()=>N(!1),placeholder:"Что искать?",className:"w-full bg-background/50 text-foreground placeholder-muted-foreground rounded-xl px-12 py-4 md:py-5 text-base md:text-lg focus:outline-none focus:border-border/50 transition-all duration-200 backdrop-blur-md border border-border/30 shadow-lg"}),t&&(0,s.jsx)("button",{onClick:()=>{r(""),null==l||l()},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors z-10",children:(0,s.jsx)(p.A,{className:"h-5 w-5"})})]}),(0,s.jsx)("button",{onClick:()=>null==u?void 0:u("tracks"===o?"playlists":"tracks"),className:"flex items-center justify-center w-12 h-12 md:w-14 md:h-14 bg-background/50 text-muted-foreground hover:text-foreground hover:bg-background/70 rounded-xl transition-all duration-200 backdrop-blur-md border border-border/30 shadow-lg",children:"tracks"===o?(0,s.jsx)(d.A,{className:"h-5 w-5 md:h-6 md:w-6"}):(0,s.jsx)(c.A,{className:"h-5 w-5 md:h-6 md:w-6"})})]}),!t&&!j&&!y&&A.length>0&&(0,s.jsxs)(m.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"mt-6 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(i.A,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsx)("h3",{className:"text-sm font-medium text-muted-foreground",children:"Недавние поиски"})]}),(0,s.jsx)("button",{onClick:P,className:"p-1 hover:bg-accent rounded-full transition-colors",title:"Очистить историю",children:(0,s.jsx)(g.A,{className:"w-4 h-4 text-muted-foreground"})})]}),(0,s.jsx)("div",{className:"space-y-1",children:A.slice(0,5).map((e,t)=>(0,s.jsxs)(m.P.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1*t},className:"flex items-center justify-between p-2 rounded-lg hover:bg-accent transition-colors group cursor-pointer",onClick:()=>E(e.query),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 flex-1",children:[(0,s.jsx)(f.A,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm text-foreground truncate",children:e.query}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground px-2 py-1 rounded-full bg-muted",children:"tracks"===e.type?"треки":"playlists"===e.type?"плейлисты":"artist"===e.type?"исполнители":"все"})]}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e.id)},className:"p-1 hover:bg-accent rounded-full opacity-0 group-hover:opacity-100 transition-all",children:(0,s.jsx)(p.A,{className:"w-3 h-3 text-muted-foreground"})})]},e.id))})]})]})})})}var T=r(47655);function I(e){let{className:t,children:r,...a}=e;return(0,s.jsxs)(T.bL,{"data-slot":"scroll-area",className:(0,A.cn)("relative",t),...a,children:[(0,s.jsx)(T.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:r}),(0,s.jsx)(O,{}),(0,s.jsx)(T.OK,{})]})}function O(e){let{className:t,orientation:r="vertical",...a}=e;return(0,s.jsx)(T.VM,{"data-slot":"scroll-area-scrollbar",orientation:r,className:(0,A.cn)("flex touch-none p-px transition-colors select-none","vertical"===r&&"h-full w-2.5 border-l border-l-transparent","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent",t),...a,children:(0,s.jsx)(T.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var R=r(44020),D=r(84616),U=r(36683),_=r(91788),F=r(5623),B=r(99708);let H=(0,r(74466).F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),V=a.forwardRef((e,t)=>{let{className:r,variant:a,size:l,asChild:n=!1,...i}=e,o=n?B.DX:"button";return(0,s.jsx)(o,{className:(0,A.cn)(H({variant:a,size:l,className:r})),ref:t,...i})});V.displayName="Button";var W=r(23853);function Q(e){let{...t}=e;return(0,s.jsx)(W.bL,{"data-slot":"dropdown-menu",...t})}function J(e){let{...t}=e;return(0,s.jsx)(W.l9,{"data-slot":"dropdown-menu-trigger",...t})}function K(e){let{className:t,sideOffset:r=4,...a}=e;return(0,s.jsx)(W.ZL,{children:(0,s.jsx)(W.UC,{"data-slot":"dropdown-menu-content",sideOffset:r,className:(0,A.cn)("backdrop-blur-xl bg-background/90 border border-border/30 shadow-2xl rounded-xl","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto p-1",t),...a})})}function q(e){let{className:t,inset:r,variant:a="default",...l}=e;return(0,s.jsx)(W.q7,{"data-slot":"dropdown-menu-item","data-inset":r,"data-variant":a,className:(0,A.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l})}function X(e){let{className:t,...r}=e;return(0,s.jsx)(W.wv,{"data-slot":"dropdown-menu-separator",className:(0,A.cn)("bg-border -mx-1 my-1 h-px",t),...r})}var Y=r(69474);function Z(e){let{...t}=e;return(0,s.jsx)(Y._s.Root,{"data-slot":"drawer",...t})}function G(e){let{...t}=e;return(0,s.jsx)(Y._s.Trigger,{"data-slot":"drawer-trigger",...t})}function $(e){let{...t}=e;return(0,s.jsx)(Y._s.Portal,{"data-slot":"drawer-portal",...t})}function ee(e){let{...t}=e;return(0,s.jsx)(Y._s.Close,{"data-slot":"drawer-close",...t})}function et(e){let{className:t,...r}=e;return(0,s.jsx)(Y._s.Overlay,{"data-slot":"drawer-overlay",className:(0,A.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...r})}function er(e){let{className:t,children:r,...a}=e;return(0,s.jsxs)($,{"data-slot":"drawer-portal",children:[(0,s.jsx)(et,{}),(0,s.jsxs)(Y._s.Content,{"data-slot":"drawer-content",className:(0,A.cn)("glass-card backdrop-blur-xl bg-black/20 border border-white/10","group/drawer-content fixed z-50 flex h-auto flex-col","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",t),...a,children:[(0,s.jsx)("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),r]})]})}function es(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"drawer-header",className:(0,A.cn)("flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left",t),...r})}function ea(e){let{className:t,...r}=e;return(0,s.jsx)(Y._s.Title,{"data-slot":"drawer-title",className:(0,A.cn)("text-foreground font-semibold",t),...r})}var el=r(15452);function en(e){let{...t}=e;return(0,s.jsx)(el.bL,{"data-slot":"dialog",...t})}function ei(e){let{...t}=e;return(0,s.jsx)(el.l9,{"data-slot":"dialog-trigger",...t})}function eo(e){let{...t}=e;return(0,s.jsx)(el.ZL,{"data-slot":"dialog-portal",...t})}function ec(e){let{className:t,...r}=e;return(0,s.jsx)(el.hJ,{"data-slot":"dialog-overlay",className:(0,A.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...r})}function ed(e){let{className:t,children:r,showCloseButton:a=!0,...l}=e;return(0,s.jsxs)(eo,{"data-slot":"dialog-portal",children:[(0,s.jsx)(ec,{}),(0,s.jsxs)(el.UC,{"data-slot":"dialog-content",className:(0,A.cn)("glass-card backdrop-blur-xl bg-black/20 border border-white/10","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg p-6 shadow-2xl shadow-black/40 duration-200 sm:max-w-lg",t),...l,children:[r,a&&(0,s.jsxs)(el.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(p.A,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function em(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:(0,A.cn)("flex flex-col gap-2 text-center sm:text-left",t),...r})}function eu(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"dialog-footer",className:(0,A.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...r})}function ex(e){let{className:t,...r}=e;return(0,s.jsx)(el.hE,{"data-slot":"dialog-title",className:(0,A.cn)("text-lg leading-none font-semibold",t),...r})}var eh=r(78952);function ef(e){let{track:t,isMobile:r=!1,open:a,onOpenChange:l}=e,{playlists:n,addTrackToPlaylist:i}=(0,eh.t)(),o=n.filter(e=>{var r;return null===(r=e.tracks)||void 0===r?void 0:r.some(e=>e.id===t.id)}),c=e=>{i(e,t),l(!1)},m=(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(I,{className:"max-h-64",children:n.length>0?(0,s.jsx)("div",{className:"space-y-1",children:n.map(e=>{let t=o.some(t=>t.id===e.id);return(0,s.jsx)(V,{variant:"ghost",className:(0,A.cn)("w-full justify-start p-2 h-auto rounded-lg transition-colors",t?"opacity-50 cursor-not-allowed bg-muted/20":"hover:bg-accent/50"),onClick:()=>c(e.id),disabled:t,children:(0,s.jsxs)("div",{className:"flex items-center w-full",children:[(0,s.jsx)("div",{className:"w-6 h-6 bg-muted/50 rounded flex items-center justify-center mr-3 flex-shrink-0",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover rounded"}):(0,s.jsx)(d.A,{className:"w-3 h-3 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"text-left flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-foreground text-sm font-medium truncate",children:e.title}),(0,s.jsxs)("p",{className:"text-muted-foreground text-xs",children:[e.trackCount," треков"]})]}),!t&&(0,s.jsx)(D.A,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"})]})},e.id)})}):(0,s.jsxs)("div",{className:"text-center py-6",children:[(0,s.jsx)(d.A,{className:"w-8 h-8 text-muted-foreground/40 mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:"Нет плейлистов"})]})})});return r?(0,s.jsx)(Z,{open:a,onOpenChange:l,children:(0,s.jsxs)(er,{className:"bg-background/80 backdrop-blur-xl border-border/50 h-1/2 shadow-2xl rounded-t-2xl",children:[(0,s.jsx)(es,{className:"sr-only",children:(0,s.jsx)(ea,{children:"Добавить в плейлист"})}),m]})}):(0,s.jsx)(en,{open:a,onOpenChange:l,children:(0,s.jsxs)(ed,{className:"bg-background/80 backdrop-blur-xl border-border/50 max-w-xs shadow-2xl rounded-2xl",children:[(0,s.jsx)(em,{className:"sr-only",children:(0,s.jsx)(ex,{children:"Добавить в плейлист"})}),m]})})}function ep(e){let{track:t,onPlay:r,onToggleLike:l,onAddToPlaylist:i,onShare:c,onDownload:d,onRemove:m,showRemove:u=!1,isFavorite:x=!1,variant:h="desktop"}=e,[f,p]=(0,a.useState)(!1);return"mobile"===h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(Z,{children:[(0,s.jsx)(G,{asChild:!0,children:(0,s.jsx)(V,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground",children:(0,s.jsx)(R.A,{className:"w-4 h-4"})})}),(0,s.jsxs)(er,{className:"bg-background border-border",children:[(0,s.jsxs)(es,{children:[(0,s.jsx)(ea,{className:"text-foreground text-left",children:t.title}),(0,s.jsx)("p",{className:"text-muted-foreground text-sm text-left",children:t.artist})]}),(0,s.jsxs)("div",{className:"p-4 space-y-2",children:[r&&(0,s.jsx)(ee,{asChild:!0,children:(0,s.jsxs)("button",{onClick:r,className:"w-full flex items-center space-x-3 p-3 rounded-lg hover:bg-accent transition-colors text-left",children:[(0,s.jsx)(n.A,{className:"w-5 h-5 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-foreground",children:"Воспроизвести"})]})}),l&&(0,s.jsx)(ee,{asChild:!0,children:(0,s.jsxs)("button",{onClick:l,className:"w-full flex items-center space-x-3 p-3 rounded-lg hover:bg-accent transition-colors text-left",children:[(0,s.jsx)(o.A,{className:"w-5 h-5 ".concat(x?"text-red-500 fill-red-500":"text-muted-foreground")}),(0,s.jsx)("span",{className:"text-foreground",children:x?"Удалить из избранного":"Добавить в избранное"})]})}),(0,s.jsx)(ee,{asChild:!0,children:(0,s.jsxs)("button",{onClick:()=>p(!0),className:"w-full flex items-center space-x-3 p-3 rounded-lg hover:bg-accent transition-colors text-left",children:[(0,s.jsx)(D.A,{className:"w-5 h-5 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-foreground",children:"Добавить в плейлист"})]})}),c&&(0,s.jsx)(ee,{asChild:!0,children:(0,s.jsxs)("button",{onClick:c,className:"w-full flex items-center space-x-3 p-3 rounded-lg hover:bg-accent transition-colors text-left",children:[(0,s.jsx)(U.A,{className:"w-5 h-5 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-foreground",children:"Поделиться"})]})}),d&&(0,s.jsx)(ee,{asChild:!0,children:(0,s.jsxs)("button",{onClick:d,className:"w-full flex items-center space-x-3 p-3 rounded-lg hover:bg-accent transition-colors text-left",children:[(0,s.jsx)(_.A,{className:"w-5 h-5 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-foreground",children:"Скачать"})]})}),u&&m&&(0,s.jsx)(ee,{asChild:!0,children:(0,s.jsxs)("button",{onClick:m,className:"w-full flex items-center space-x-3 p-3 rounded-lg hover:bg-white/5 transition-colors text-left",children:[(0,s.jsx)(g.A,{className:"w-5 h-5 text-red-400"}),(0,s.jsx)("span",{className:"text-red-400",children:"Удалить"})]})}),(0,s.jsx)("div",{className:"h-8"})," "]})]})]}),(0,s.jsx)(ef,{track:t,isMobile:!0,open:f,onOpenChange:p})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(Q,{children:[(0,s.jsx)(J,{asChild:!0,children:(0,s.jsx)(V,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground transition-all",children:(0,s.jsx)(F.A,{className:"w-4 h-4"})})}),(0,s.jsxs)(K,{className:"min-w-48",children:[r&&(0,s.jsxs)(q,{onClick:r,children:[(0,s.jsx)(n.A,{className:"w-4 h-4 mr-2"}),"Воспроизвести"]}),l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(q,{onClick:l,children:[(0,s.jsx)(o.A,{className:"w-4 h-4 mr-2 ".concat(x?"text-red-500 fill-red-500":"")}),x?"Удалить из избранного":"Добавить в избранное"]}),(0,s.jsx)(X,{className:"bg-white/10"})]}),(0,s.jsxs)(q,{onClick:()=>p(!0),children:[(0,s.jsx)(D.A,{className:"w-4 h-4 mr-2"}),"Добавить в плейлист"]}),c&&(0,s.jsxs)(q,{onClick:c,children:[(0,s.jsx)(U.A,{className:"w-4 h-4 mr-2"}),"Поделиться"]}),d&&(0,s.jsxs)(q,{onClick:d,children:[(0,s.jsx)(_.A,{className:"w-4 h-4 mr-2"}),"Скачать"]}),u&&m&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X,{className:"bg-white/10"}),(0,s.jsxs)(q,{onClick:m,className:"text-red-400 focus:text-red-300",children:[(0,s.jsx)(g.A,{className:"w-4 h-4 mr-2"}),"Удалить"]})]})]})]}),(0,s.jsx)(ef,{track:t,open:f,onOpenChange:p})]})}var eg=r(13717);function eb(e){let{isOpen:t,onClose:r,x:l,y:n,children:i,className:o}=e,c=(0,a.useRef)(null);return((0,a.useEffect)(()=>{let e=e=>{c.current&&!c.current.contains(e.target)&&r()};return t&&(document.addEventListener("mousedown",e),document.addEventListener("keydown",e=>{"Escape"===e.key&&r()})),()=>{document.removeEventListener("mousedown",e)}},[t,r]),t)?(0,s.jsx)(u.N,{children:(0,s.jsx)(m.P.div,{ref:c,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.1},className:(0,A.cn)("fixed z-50 bg-background/90 backdrop-blur-xl border border-border/30 rounded-xl shadow-2xl min-w-[200px]",o),style:{left:l,top:n,transform:"translate(-50%, -100%)"},children:i})}):null}function ev(e){let{icon:t,children:r,onClick:a,disabled:l=!1,variant:n="default",className:i}=e;return(0,s.jsxs)("button",{onClick:a,disabled:l,className:(0,A.cn)("w-full flex items-center space-x-3 px-4 py-3 text-left hover:bg-accent transition-colors first:rounded-t-xl last:rounded-b-xl disabled:opacity-50 disabled:cursor-not-allowed","destructive"===n&&"text-destructive hover:bg-destructive/10","default"===n&&"text-foreground",i),children:[t&&(0,s.jsx)("span",{className:"w-4 h-4",children:t}),(0,s.jsx)("span",{className:"text-sm font-medium",children:r})]})}function ej(e){let{isOpen:t,onClose:r,x:a,y:l,track:i,onPlay:c,onToggleLike:d,onAddToPlaylist:m,onDownload:u}=e;return(0,s.jsxs)(eb,{isOpen:t,onClose:r,x:a,y:l,children:[(0,s.jsx)(ev,{icon:(0,s.jsx)(n.A,{className:"w-4 h-4"}),onClick:c,children:"Воспроизвести"}),(0,s.jsx)(ev,{icon:(0,s.jsx)(o.A,{className:"w-4 h-4 ".concat((null==i?void 0:i.isLiked)?"text-red-500":"")}),onClick:d,className:(null==i?void 0:i.isLiked)?"text-red-500":"",children:(null==i?void 0:i.isLiked)?"Убрать из избранного":"Добавить в избранное"}),(0,s.jsx)(ev,{icon:(0,s.jsx)(D.A,{className:"w-4 h-4"}),onClick:m,children:"Добавить в плейлист"}),(0,s.jsx)(ev,{icon:(0,s.jsx)(_.A,{className:"w-4 h-4"}),onClick:u,children:"Скачать"})]})}function ey(e){let{isOpen:t,onClose:r,x:a,y:l,playlist:i,onPlay:o,onExport:c,onEdit:d,onDelete:m}=e,u=(null==i?void 0:i.id)==="favorites";return(0,s.jsxs)(eb,{isOpen:t,onClose:r,x:a,y:l,children:[(0,s.jsx)(ev,{icon:(0,s.jsx)(n.A,{className:"w-4 h-4"}),onClick:o,children:"Воспроизвести"}),(0,s.jsx)(ev,{icon:(0,s.jsx)(_.A,{className:"w-4 h-4"}),onClick:c,children:"Экспорт в JSON"}),!u&&(0,s.jsx)(ev,{icon:(0,s.jsx)(eg.A,{className:"w-4 h-4"}),onClick:d,children:"Редактировать"}),!u&&(0,s.jsx)(ev,{icon:(0,s.jsx)(g.A,{className:"w-4 h-4"}),onClick:m,variant:"destructive",children:"Удалить"})]})}function eN(e){let{className:t,type:r,...a}=e;return(0,s.jsx)("input",{type:r,"data-slot":"input",className:(0,A.cn)("placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground flex h-12 w-full min-w-0 rounded-full border-0 bg-input px-4 py-1 text-foreground text-sm shadow-xs transition-colors outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50","focus:outline-none focus:ring-0 focus:border-0",t),...a})}var ew=r(60704);function ek(e){let{className:t,...r}=e;return(0,s.jsx)(ew.bL,{"data-slot":"tabs",className:(0,A.cn)("flex flex-col gap-2",t),...r})}function eA(e){let{className:t,...r}=e;return(0,s.jsx)(ew.B8,{"data-slot":"tabs-list",className:(0,A.cn)("bg-background/20 backdrop-blur-sm border border-border/30 text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...r})}function eC(e){let{className:t,...r}=e;return(0,s.jsx)(ew.l9,{"data-slot":"tabs-trigger",className:(0,A.cn)("data-[state=active]:bg-accent/20 data-[state=active]:text-foreground data-[state=active]:border-accent/30 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring text-muted-foreground hover:text-foreground hover:bg-background/10 inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-all focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...r})}function eS(e){let{className:t,...r}=e;return(0,s.jsx)(ew.UC,{"data-slot":"tabs-content",className:(0,A.cn)("flex-1 outline-none",t),...r})}var eP=r(33127),ez=r(29869),eL=r(5196);function eM(e){let{isOpen:t,onClose:r,playlist:l,onRename:n,onCoverChange:i,onCoverRemove:o}=e,[c,m]=(0,a.useState)("general"),[u,x]=(0,a.useState)((null==l?void 0:l.title)||""),[h,f]=(0,a.useState)(""),[b,v]=(0,a.useState)(!1),j=(0,a.useRef)(null);(0,a.useEffect)(()=>{(null==l?void 0:l.title)&&x(l.title),f("")},[null==l?void 0:l.title]);let y=async()=>{if(u.trim()){v(!0);try{await n(u.trim()),r()}catch(e){console.error("Ошибка при переименовании:",e)}finally{v(!1)}}},N=async()=>{if(h.trim()){v(!0);try{await i(h.trim()),r()}catch(e){console.error("Ошибка при смене обложки:",e)}finally{v(!1)}}},w=async()=>{v(!0);try{await o(),r()}catch(e){console.error("Ошибка при удалении обложки:",e)}finally{v(!1)}},k=e=>{"Enter"===e.key&&("general"===c?y():"cover"===c&&N())};return(0,s.jsx)(en,{open:t,onOpenChange:r,children:(0,s.jsxs)(ed,{className:"bg-gradient-to-br from-background via-background/95 to-background/90 backdrop-blur-xl border border-border/50 max-w-2xl shadow-2xl",children:[(0,s.jsx)(em,{className:"text-center",children:(0,s.jsxs)(ex,{className:"text-foreground flex items-center justify-center space-x-2 text-xl font-bold",children:[(0,s.jsx)(eg.A,{className:"w-6 h-6 text-primary"}),(0,s.jsx)("span",{children:"Редактировать плейлист"})]})}),(0,s.jsxs)(ek,{value:c,onValueChange:m,className:"w-full",children:[(0,s.jsxs)(eA,{className:"grid w-full grid-cols-2 bg-muted/30 backdrop-blur-sm border border-border/30",children:[(0,s.jsxs)(eC,{value:"general",className:"flex items-center gap-2 data-[state=active]:bg-primary/20 data-[state=active]:text-primary",children:[(0,s.jsx)(d.A,{className:"w-4 h-4"}),"Основное"]}),(0,s.jsxs)(eC,{value:"cover",className:"flex items-center gap-2 data-[state=active]:bg-primary/20 data-[state=active]:text-primary",children:[(0,s.jsx)(eP.A,{className:"w-4 h-4"}),"Обложка"]})]}),(0,s.jsxs)(eS,{value:"general",className:"space-y-6 mt-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-24 h-24 mx-auto bg-gradient-to-br from-primary/20 to-primary/10 rounded-2xl flex items-center justify-center mb-4 border border-primary/20",children:(0,s.jsx)(d.A,{className:"w-12 h-12 text-primary"})}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Основная информация"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Измените название плейлиста"})]}),(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Название плейлиста"}),(0,s.jsx)(eN,{value:u,onChange:e=>x(e.target.value),onKeyPress:k,placeholder:"Введите новое название",className:"bg-background/50 border-border/50 text-foreground placeholder:text-muted-foreground/50 focus:border-primary/50 focus:ring-primary/20",autoFocus:!0})]})})]}),(0,s.jsxs)(eS,{value:"cover",className:"space-y-6 mt-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-24 h-24 mx-auto bg-gradient-to-br from-accent/20 to-accent/10 rounded-2xl flex items-center justify-center mb-4 border border-accent/20",children:(0,s.jsx)(eP.A,{className:"w-12 h-12 text-accent"})}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Обложка плейлиста"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Загрузите новую обложку или введите URL"})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(null==l?void 0:l.coverArt)&&(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-foreground mb-3 block",children:"Текущая обложка"}),(0,s.jsx)("div",{className:"w-32 h-32 mx-auto bg-muted/30 rounded-2xl overflow-hidden border border-border/30 shadow-lg",children:(0,s.jsx)("img",{src:l.coverArt,alt:"Текущая обложка",className:"w-full h-full object-cover"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-foreground mb-3 block",children:"Загрузить файл"}),(0,s.jsxs)(V,{variant:"outline",onClick:()=>{var e;return null===(e=j.current)||void 0===e?void 0:e.click()},className:"w-full justify-center gap-3 bg-background/50 border-border/50 hover:bg-background/80 hover:border-primary/50 transition-all duration-200",children:[(0,s.jsx)(ez.A,{className:"w-4 h-4"}),"Выбрать файл"]}),(0,s.jsx)("input",{ref:j,type:"file",accept:"image/*",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){let e=new FileReader;e.onload=e=>{var t;f(null===(t=e.target)||void 0===t?void 0:t.result)},e.readAsDataURL(r)}},className:"hidden"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-foreground mb-3 block",children:"Или введите URL"}),(0,s.jsx)(eN,{value:h,onChange:e=>f(e.target.value),onKeyPress:k,placeholder:"https://example.com/image.jpg",className:"bg-background/50 border-border/50 text-foreground placeholder:text-muted-foreground/50 focus:border-primary/50 focus:ring-primary/20"})]}),h&&(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-foreground mb-3 block",children:"Предпросмотр"}),(0,s.jsxs)("div",{className:"w-32 h-32 mx-auto bg-muted/30 rounded-2xl overflow-hidden border border-border/30 shadow-lg",children:[(0,s.jsx)("img",{src:h,alt:"Предпросмотр",className:"w-full h-full object-cover",onError:e=>{e.currentTarget.style.display="none",e.currentTarget.nextElementSibling.style.display="flex"}}),(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground text-xs",children:"Ошибка загрузки"})]})]})]})]})]}),(0,s.jsxs)(eu,{className:"flex justify-center space-x-3 mt-6",children:["cover"===c&&(null==l?void 0:l.coverArt)&&(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:w,disabled:b,className:"w-12 h-12 rounded-2xl text-destructive hover:text-destructive hover:bg-destructive/10 border border-destructive/20 hover:border-destructive/30 transition-all duration-200",title:"Удалить обложку",children:(0,s.jsx)(g.A,{className:"w-5 h-5"})}),(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:r,className:"w-12 h-12 rounded-2xl text-muted-foreground hover:text-foreground hover:bg-accent/20 border border-border/30 hover:border-accent/30 transition-all duration-200",title:"Отмена",children:(0,s.jsx)(p.A,{className:"w-5 h-5"})}),(0,s.jsx)(V,{size:"icon",onClick:"general"===c?y:N,disabled:"general"===c?!u.trim():!h.trim()||b,className:"w-12 h-12 rounded-2xl bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70 text-primary-foreground shadow-lg hover:shadow-xl transition-all duration-200",title:"Сохранить",children:b?(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):(0,s.jsx)(eL.A,{className:"w-5 h-5"})})]})]})})}function eE(e){try{let t={title:e.title||"Без названия",artist:e.artist||"Неизвестный исполнитель",trackCount:e.trackCount||0,duration:e.duration||"0:00",coverArt:e.coverArt||null,tracks:(e.tracks||[]).map(e=>({id:e.id||"",title:e.title||"Без названия",artist:e.artist||"Неизвестный исполнитель",duration:e.duration||"0:00",coverArt:e.coverArt||null,source:e.source||"unknown",url:e.url||void 0})),exportDate:new Date().toISOString(),exportVersion:"1.0.0"},r=JSON.stringify(t,null,2),s=new Blob([r],{type:"application/json"}),a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download="".concat(e.title||"playlist",".json"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}catch(e){throw console.error("Ошибка при экспорте плейлиста:",e),Error("Не удалось экспортировать плейлист")}}function eT(e){try{let t=JSON.parse(e);if(!t.title||!Array.isArray(t.tracks))throw Error("Неверный формат файла плейлиста");return t}catch(e){throw console.error("Ошибка при импорте плейлиста:",e),Error("Не удалось импортировать плейлист из файла")}}function eI(e){let{tracks:t,playlists:r,searchQuery:l,onTrackSelect:i,onPlaylistSelect:o,onAddToPlaylist:m,onDownloadTrack:u,onShareTrack:x,isLoading:h=!1,searchType:f="tracks"}=e,{toggleFavorite:p,isFavorite:g}=(0,eh.t)(),[b,v]=(0,a.useState)(!1),[j,y]=(0,a.useState)({type:"track",isOpen:!1,x:0,y:0,item:null}),[N,w]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=()=>{v(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let k=t.filter(e=>e.title.toLowerCase().includes(l.toLowerCase())||e.artist.toLowerCase().includes(l.toLowerCase())),A=r.filter(e=>e.title.toLowerCase().includes(l.toLowerCase())||e.artist.toLowerCase().includes(l.toLowerCase())),S=(e,t,r)=>{e.preventDefault(),y({type:t,isOpen:!0,x:e.clientX,y:e.clientY,item:r})},P=()=>{y(e=>({...e,isOpen:!1}))},z=async e=>{if(j.item&&"playlist"===j.type)try{console.log("Переименование плейлиста:",j.item.id,"в",e),P()}catch(e){console.error("Ошибка при переименовании плейлиста:",e)}},L=async e=>{if(j.item&&"playlist"===j.type)try{console.log("Смена обложки плейлиста:",j.item.id,"на",e),P()}catch(e){console.error("Ошибка при смене обложки плейлиста:",e)}},M=async()=>{if(j.item&&"playlist"===j.type)try{console.log("Удаление обложки плейлиста:",j.item.id),P()}catch(e){console.error("Ошибка при удалении обложки плейлиста:",e)}},E=e=>{try{eE(e)}catch(e){console.error("Ошибка при экспорте плейлиста:",e)}};return(0,s.jsxs)("div",{className:"flex-1 bg-background text-foreground",children:[(0,s.jsx)(I,{className:"flex-1 h-full",children:(0,s.jsx)("div",{className:"pb-4",children:h?(0,s.jsx)(C,{title:"Поиск...",subtitle:"Ищем результаты",variant:"search",className:"h-full"}):"tracks"===f?(0,s.jsx)("div",{className:"px-4",children:k.length>0?(0,s.jsx)("div",{className:"space-y-3 md:grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 md:gap-4 md:space-y-0",children:k.map((e,t)=>(0,s.jsxs)("div",{onClick:()=>i(e),onContextMenu:t=>S(t,"track",e),className:"flex items-center p-3 md:p-4 rounded-xl hover:bg-accent/50 transition-all duration-200 cursor-pointer group bg-card/30 backdrop-blur-sm border border-border/50 hover:border-border hover:shadow-lg",children:[(0,s.jsx)("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-muted/50 rounded-xl flex items-center justify-center mr-4 flex-shrink-0 backdrop-blur-sm border border-border/30 overflow-hidden shadow-sm",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover rounded-xl"}):(0,s.jsx)(d.A,{className:"w-7 h-7 md:w-8 md:h-8 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0 mr-2",children:[(0,s.jsx)("h3",{className:"text-foreground font-semibold ".concat(b?"text-sm break-words mb-1 leading-tight":"text-sm md:text-base break-words mb-1 leading-tight"),children:e.title}),(0,s.jsx)("p",{className:"text-muted-foreground ".concat(b?"text-xs break-words leading-tight":"text-xs md:text-sm break-words leading-tight"),children:e.artist}),(0,s.jsx)("p",{className:"text-muted-foreground/70 text-xs ".concat("break-words leading-tight"),children:e.duration})]}),(0,s.jsxs)("div",{className:"flex items-center flex-shrink-0 ml-auto",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"flex-shrink-0 mr-2",children:(0,s.jsx)("div",{className:"w-8 h-8 bg-primary/20 rounded-full flex items-center justify-center group-hover:bg-primary/30 transition-colors",children:(0,s.jsx)(n.A,{className:"w-4 h-4 text-primary ml-0.5"})})}),(0,s.jsx)(ep,{track:e,variant:b?"mobile":"desktop",onPlay:()=>i(e),onToggleLike:()=>p(e),onAddToPlaylist:m?()=>m(e):void 0,onShare:x?()=>x(e):void 0,isFavorite:g(e.id)})]})]},e.id))}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px]",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-4 backdrop-blur-sm border border-border",children:(0,s.jsx)(d.A,{className:"w-8 h-8 text-muted-foreground"})}),(0,s.jsx)("p",{className:"text-muted-foreground text-lg",children:"Треки не найдены"})]})}):(0,s.jsx)("div",{className:"px-4",children:A.length>0?(0,s.jsx)("div",{className:"space-y-3 md:grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 md:gap-4 md:space-y-0",children:A.map((e,t)=>(0,s.jsxs)("div",{onClick:()=>o(e),onContextMenu:t=>S(t,"playlist",e),className:"flex items-center p-3 md:p-4 rounded-xl hover:bg-accent/50 transition-all duration-200 cursor-pointer group bg-card/30 backdrop-blur-sm border border-border/50 hover:border-border hover:shadow-lg",children:[(0,s.jsx)("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-muted/50 rounded-xl flex items-center justify-center mr-4 flex-shrink-0 backdrop-blur-sm border border-border/30 overflow-hidden shadow-sm",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover rounded-xl"}):(0,s.jsx)(c.A,{className:"w-7 h-7 md:w-8 md:h-8 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-foreground text-sm md:text-base font-semibold break-words leading-tight mb-1",children:e.title}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs md:text-sm break-words leading-tight",children:e.artist}),e.trackCount&&(0,s.jsxs)("p",{className:"text-muted-foreground/70 text-xs mt-1 break-words leading-tight",children:[e.trackCount," треков"]})]}),(0,s.jsx)("div",{className:"flex-shrink-0 ml-2",children:(0,s.jsx)("div",{className:"w-8 h-8 bg-primary/20 rounded-full flex items-center justify-center group-hover:bg-primary/30 transition-colors",children:(0,s.jsx)(n.A,{className:"w-4 h-4 text-primary ml-0.5"})})})]},e.id))}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full min-h-[400px]",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-4 backdrop-blur-sm border border-border",children:(0,s.jsx)(c.A,{className:"w-8 h-8 text-muted-foreground"})}),(0,s.jsx)("p",{className:"text-muted-foreground text-lg",children:"Плейлисты не найдены"})]})})})}),j.isOpen&&j.item&&(0,s.jsxs)(s.Fragment,{children:["track"===j.type&&(0,s.jsx)(ej,{isOpen:j.isOpen,onClose:P,x:j.x,y:j.y,track:{...j.item,isLiked:g(j.item.id)},onPlay:()=>{i(j.item),P()},onToggleLike:()=>{p(j.item),P()},onAddToPlaylist:()=>{m&&m(j.item),P()},onDownload:()=>{u&&j.item&&u(j.item),P()}}),"playlist"===j.type&&(0,s.jsx)(ey,{isOpen:j.isOpen,onClose:P,x:j.x,y:j.y,playlist:j.item,onPlay:()=>{var e;let t=null===(e=j.item.tracks)||void 0===e?void 0:e[0];t&&i(t),P()},onExport:()=>{E(j.item),P()},onEdit:()=>{w(!0),P()},onDelete:()=>{P()}})]}),j.item&&"playlist"===j.type&&(0,s.jsx)(eM,{isOpen:N,onClose:()=>w(!1),playlist:j.item,onRename:z,onCoverChange:L,onCoverRemove:M})]})}var eO=r(41335),eR=r(9389),eD=r(82178),eU=r(96675),e_=r(50825);function eF(e){let{currentTime:t,duration:r,onSeek:l,className:n=""}=e,[i,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(0),u=(0,a.useRef)(null),[x,h]=(0,a.useState)([]);(0,a.useEffect)(()=>{(()=>{let e=[],t=Math.random();for(let r=0;r<60;r++){let s=.1;t<.2?s=.4*Math.sin(.3*r)+.5+.2*Math.random():t<.4?(s=.8*Math.random()+.2,r%8<3&&(s*=1.5)):t<.6?s=.3*Math.sin(.1*r)+.4+.3*Math.random():t<.8?(s=.6*Math.random()+.2,r%12<4&&(s=.9*Math.random()+.1)):s=.9*Math.random()+.1,s=Math.max(.1,Math.min(1,s)),e.push(s)}h(e)})()},[]);let f=r>0?t/r*100:0,p=i?c:f,g=()=>{o(!1)},b=e=>{if(!isFinite(e)||isNaN(e))return"0:00";let t=Math.floor(Math.abs(e)/60),r=Math.floor(Math.abs(e)%60);return"".concat(t,":").concat(r.toString().padStart(2,"0"))};return(0,s.jsx)("div",{className:"w-full ".concat(n),children:(0,s.jsxs)("div",{className:"flex items-center space-x-3 md:space-x-4",children:[(0,s.jsx)("span",{className:"text-muted-foreground text-sm md:text-base font-mono min-w-[3rem] md:min-w-[4rem] text-right",children:b(t)}),(0,s.jsx)("div",{ref:u,className:"relative flex-1 h-8 md:h-10 lg:h-12 cursor-pointer transition-transform duration-200",onMouseDown:e=>{if(!u.current)return;o(!0);let t=u.current.getBoundingClientRect(),s=Math.max(0,Math.min(100,(e.clientX-t.left)/t.width*100));d(s),l(s/100*r)},onMouseMove:e=>{if(!i||!u.current)return;let t=u.current.getBoundingClientRect(),s=Math.max(0,Math.min(100,(e.clientX-t.left)/t.width*100));d(s),l(s/100*r)},onMouseUp:g,onMouseLeave:g,children:(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"flex items-center space-x-0.5 md:space-x-1 h-6 md:h-8 lg:h-10",children:x.map((e,t)=>{let r=t/x.length*100<=p,a=20*e;return(0,s.jsx)(m.P.div,{className:"w-0.5 md:w-1 lg:w-1.5 rounded-full transition-colors duration-150 ".concat(r?"bg-primary shadow-sm":"bg-muted-foreground/30"),style:{height:"".concat(a,"px"),minHeight:"2px"},initial:{height:0},animate:{height:"".concat(a,"px")},transition:{delay:.005*t,duration:.2}},t)})})})}),(0,s.jsx)("span",{className:"text-muted-foreground text-sm md:text-base font-mono min-w-[3rem] md:min-w-[4rem] text-left",children:b(r)})]})})}function eB(e){let{track:t,nextTrack:r,previousTrack:a,isPlaying:l,isLoading:i=!1,currentTime:c=0,duration:u=0,volume:x=1,repeatMode:h="none",shuffle:f=!1,onPlayPause:g,onNext:b,onPrevious:v,onSeek:j,onVolumeChange:y,onRepeatToggle:N,onShuffleToggle:w,onBack:k,onToggleLike:A,onAddToPlaylist:C,isLiked:S=!1}=e,P=()=>{var e;let r="".concat(t.title," - ").concat(t.artist);if(null===(e=window.Telegram)||void 0===e?void 0:e.WebApp)try{let e=window.Telegram.WebApp;if(e.switchInlineQuery&&"function"==typeof e.switchInlineQuery){console.log("Using switchInlineQuery with query:",r),e.switchInlineQuery(r,["users","groups","channels"]);return}if(console.log("switchInlineQuery not available, trying openTelegramLink"),e.openTelegramLink&&"function"==typeof e.openTelegramLink){let t="https://t.me/nodotify_bot?startapp=".concat(encodeURIComponent(r));console.log("Using openTelegramLink with startapp URL:",t),e.openTelegramLink(t);return}if(e.openLink&&"function"==typeof e.openLink){let t="https://t.me/nodotify_bot?startapp=".concat(encodeURIComponent(r));console.log("Using openLink with startapp URL:",t),e.openLink(t);return}let t="https://t.me/nodotify_bot?startapp=".concat(encodeURIComponent(r));console.log("Using fallback URL:",t),window.open(t,"_blank")}catch(t){console.log("Telegram WebApp methods not available, using fallback:",t);let e="https://t.me/nodotify_bot?startapp=".concat(encodeURIComponent(r));window.open(e,"_blank")}else{let e="https://t.me/nodotify_bot?startapp=".concat(encodeURIComponent(r));window.open(e,"_blank")}},z=t.duration.split(":"),L=60*Number.parseInt(z[0])+Number.parseInt(z[1]),M=u>0?u:L,E=c>0?c:0;return(0,s.jsxs)("div",{className:"min-h-screen bg-background text-foreground flex flex-col",children:[(0,s.jsxs)("div",{className:"relative p-4 md:p-6 pt-4 md:pt-6",children:[(0,s.jsx)("div",{className:"hidden md:block absolute top-4 left-4 z-10",children:(0,s.jsx)(V,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground hover:bg-accent rounded-full w-12 h-12 shadow-lg backdrop-blur-sm",onClick:k,children:(0,s.jsx)(p.A,{className:"h-6 w-6"})})}),(0,s.jsx)("div",{className:"hidden md:flex absolute top-4 right-4 z-10",children:(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:P,className:"text-muted-foreground hover:text-foreground hover:bg-accent rounded-full w-12 h-12 shadow-lg backdrop-blur-sm",children:(0,s.jsx)(U.A,{className:"h-6 w-6"})})}),(0,s.jsxs)("div",{className:"flex items-center justify-between md:hidden",children:[(0,s.jsx)(V,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-foreground hover:bg-accent rounded-full w-10 h-10",onClick:k,children:(0,s.jsx)(p.A,{className:"h-6 w-6"})}),"repeat"===h?(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-6 h-6 bg-muted rounded flex items-center justify-center",children:(0,s.jsx)(eO.A,{className:"w-3 h-3 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Повтор"}),(0,s.jsx)("p",{className:"text-sm text-foreground truncate max-w-32",children:"Текущий трек"})]})]}):r?(0,s.jsxs)("div",{className:"flex items-center space-x-2 bg-accent/20 backdrop-blur-md border border-accent/30 rounded-lg p-2 hover:bg-accent/30 transition-colors shadow-lg",children:[(0,s.jsx)("div",{className:"w-6 h-6 bg-background/40 rounded flex items-center justify-center overflow-hidden border border-border/30",children:r.coverArt?(0,s.jsx)("img",{src:r.coverArt,alt:r.title,className:"w-full h-full object-cover"}):(0,s.jsx)(d.A,{className:"w-3 h-3 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Следующий"}),(0,s.jsx)("p",{className:"text-sm text-foreground truncate max-w-32",children:r.title})]})]}):null,(0,s.jsx)("div",{className:"flex items-center space-x-1",children:(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:P,className:"text-muted-foreground hover:text-foreground hover:bg-accent rounded-full w-10 h-10",children:(0,s.jsx)(U.A,{className:"h-5 w-5"})})})]}),(0,s.jsx)("div",{className:"hidden md:flex justify-center items-center",children:"repeat"===h?(0,s.jsxs)("div",{className:"flex items-center space-x-3 bg-muted rounded-xl p-3 backdrop-blur-sm",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-muted rounded-lg flex items-center justify-center",children:(0,s.jsx)(eO.A,{className:"w-4 h-4 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm text-foreground font-medium",children:"Режим повтора"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Текущий трек"})]})]}):r?(0,s.jsxs)("div",{className:"flex items-center space-x-3 bg-accent/20 backdrop-blur-md border border-accent/30 rounded-xl p-3 hover:bg-accent/30 transition-colors shadow-lg",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-background/40 rounded-lg flex items-center justify-center overflow-hidden border border-border/30 shadow-sm",children:r.coverArt?(0,s.jsx)("img",{src:r.coverArt,alt:r.title,className:"w-full h-full object-cover rounded-md"}):(0,s.jsx)(d.A,{className:"w-4 h-4 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm text-foreground font-medium",children:"Следующий трек"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground truncate max-w-40",children:r.title})]})]}):null})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center px-6 md:hidden",children:[(0,s.jsx)(m.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:200,damping:20},className:"relative mb-8 flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-80 h-80 md:w-96 md:h-96 lg:w-[28rem] lg:h-[28rem] bg-muted rounded-3xl flex items-center justify-center backdrop-blur-sm border border-border shadow-2xl z-10",children:t.coverArt?(0,s.jsx)("img",{src:t.coverArt,alt:t.title,className:"w-full h-full rounded-3xl object-cover"}):(0,s.jsx)("div",{className:"w-32 h-32 bg-muted rounded-full flex items-center justify-center backdrop-blur-sm border border-border",children:(0,s.jsx)(n.A,{className:"w-16 h-16 text-foreground"})})})}),(0,s.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"text-center mb-8 w-full",children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-medium text-foreground mb-1 md:mb-2 truncate max-w-[280px] md:max-w-[320px] lg:max-w-[400px] mx-auto",children:t.title}),(0,s.jsx)("p",{className:"text-base md:text-lg lg:text-xl text-muted-foreground truncate max-w-[280px] md:max-w-[320px] lg:max-w-[400px] mx-auto",children:t.artist})]}),(0,s.jsx)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"w-full mb-8",children:(0,s.jsx)(eF,{currentTime:E,duration:M,onSeek:e=>j&&j(e)})}),(0,s.jsx)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"w-full mb-8",children:(0,s.jsx)("div",{className:"bg-accent/20 backdrop-blur-md border border-accent/30 rounded-2xl p-6 md:p-8 hover:bg-accent/30 transition-colors shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-6 md:space-x-8",children:[(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:v,className:"text-muted-foreground hover:text-foreground hover:bg-background/50 rounded-full w-12 h-12 md:w-14 md:h-14 lg:w-16 lg:h-16 border border-transparent hover:border-border/30 transition-all",children:(0,s.jsx)(eR.A,{className:"w-6 h-6 md:w-7 md:h-7 lg:w-8 lg:h-8"})}),(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:g,disabled:i,className:"w-16 h-16 md:w-20 md:h-20 lg:w-24 lg:h-24 rounded-full bg-primary text-primary-foreground hover:bg-primary/90 shadow-lg disabled:opacity-50 border border-primary/20 hover:border-primary/40 transition-all",children:i?(0,s.jsx)("div",{className:"w-6 h-6 md:w-8 md:h-8 border-2 border-primary-foreground/30 border-t-primary-foreground rounded-full animate-spin"}):l?(0,s.jsx)(eD.A,{className:"w-8 h-8 md:w-10 md:h-10 lg:w-12 lg:h-12"}):(0,s.jsx)(n.A,{className:"w-8 h-8 md:w-10 md:h-10 lg:w-12 lg:h-12 ml-1"})}),(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:b,className:"text-muted-foreground hover:text-foreground hover:bg-background/50 rounded-full w-12 h-12 md:w-14 md:h-14 lg:w-16 lg:h-16 border border-transparent hover:border-border/30 transition-all",children:(0,s.jsx)(eU.A,{className:"w-6 h-6 md:w-7 md:h-7 lg:w-8 lg:h-8"})})]})})}),(0,s.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"flex items-center justify-between w-full px-16 md:px-24",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:w,className:"".concat(f?"text-foreground bg-accent/20 border border-accent/30":"text-muted-foreground"," hover:text-foreground hover:bg-accent/30 rounded-full w-12 h-12 md:w-14 md:h-14 border border-transparent hover:border-accent/20 transition-all"),children:(0,s.jsx)(e_.A,{className:"w-6 h-6 md:w-7 md:h-7"})}),(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:N,className:"".concat("none"!==h?"text-foreground bg-accent/20 border border-accent/30":"text-muted-foreground"," hover:text-foreground hover:bg-accent/30 rounded-full w-12 h-12 md:w-14 md:h-14 border border-transparent hover:border-accent/20 transition-all"),children:(0,s.jsx)(eO.A,{className:"w-6 h-6 md:w-7 md:h-7"})})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[A&&(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:A,className:"text-muted-foreground hover:text-foreground hover:bg-accent rounded-full w-12 h-12 ".concat(S?"text-red-500 hover:text-red-400":""),children:(0,s.jsx)(o.A,{className:"h-6 w-6 ".concat(S?"fill-current":"")})}),C&&(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:C,className:"text-muted-foreground hover:text-foreground hover:bg-accent rounded-full w-12 h-12",children:(0,s.jsx)(D.A,{className:"h-6 w-6"})})]})]})]}),(0,s.jsx)("div",{className:"hidden md:flex flex-1 items-center justify-center px-8 lg:px-12",children:(0,s.jsx)("div",{className:"w-full max-w-6xl",children:(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-8 items-center",children:[(0,s.jsx)("div",{className:"col-span-5 lg:col-span-4",children:(0,s.jsxs)(m.P.div,{initial:{scale:.8,opacity:0,x:-50},animate:{scale:1,opacity:1,x:0},transition:{type:"spring",stiffness:200,damping:20},className:"relative",children:[(0,s.jsx)("div",{className:"aspect-square bg-muted rounded-3xl flex items-center justify-center backdrop-blur-sm border border-border shadow-2xl",children:t.coverArt?(0,s.jsx)("img",{src:t.coverArt,alt:t.title,className:"w-full h-full rounded-3xl object-cover"}):(0,s.jsx)("div",{className:"w-24 h-24 bg-muted rounded-full flex items-center justify-center backdrop-blur-sm border border-border",children:(0,s.jsx)(n.A,{className:"w-12 h-12 text-foreground"})})}),A&&(0,s.jsx)(m.P.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.6},className:"absolute -bottom-2 -left-2",children:(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:A,className:"w-12 h-12 rounded-full shadow-lg backdrop-blur-sm border border-border ".concat(S?"text-red-500 bg-red-500/20 hover:bg-red-500/30":"text-muted-foreground bg-background/50 hover:bg-background/70"),title:"Добавить в избранное",children:(0,s.jsx)(o.A,{className:"h-6 w-6 ".concat(S?"fill-current":"")})})}),C&&(0,s.jsx)(m.P.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7},className:"absolute -bottom-2 -right-2",children:(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:C,className:"w-12 h-12 rounded-full shadow-lg backdrop-blur-sm border border-border text-muted-foreground bg-background/50 hover:bg-background/70",title:"Добавить в плейлист",children:(0,s.jsx)(D.A,{className:"h-6 w-6"})})})]})}),(0,s.jsxs)("div",{className:"col-span-7 lg:col-span-8 space-y-6",children:[(0,s.jsxs)(m.P.div,{initial:{opacity:0,y:20,x:50},animate:{opacity:1,y:0,x:0},transition:{delay:.2},className:"text-center",children:[(0,s.jsx)("h1",{className:"text-3xl lg:text-4xl font-bold text-foreground mb-2 line-clamp-2",children:t.title}),(0,s.jsx)("p",{className:"text-xl lg:text-2xl text-muted-foreground",children:t.artist})]}),(0,s.jsx)(m.P.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{delay:.3},children:(0,s.jsx)(eF,{currentTime:E,duration:M,onSeek:e=>j&&j(e)})}),(0,s.jsx)(m.P.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{delay:.4},className:"bg-accent/20 backdrop-blur-md border border-accent/30 rounded-2xl p-6 hover:bg-accent/30 transition-colors shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:w,className:"".concat(f?"text-foreground bg-accent/20 border border-accent/30":"text-muted-foreground"," hover:text-foreground hover:bg-accent/30 rounded-full w-12 h-12 border border-transparent hover:border-accent/20 transition-all"),children:(0,s.jsx)(e_.A,{className:"w-6 h-6"})}),(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:v,className:"text-muted-foreground hover:text-foreground hover:bg-accent rounded-full w-14 h-14",children:(0,s.jsx)(eR.A,{className:"w-7 h-7"})}),(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:g,disabled:i,className:"w-18 h-18 rounded-full bg-primary text-primary-foreground hover:bg-primary/90 shadow-lg disabled:opacity-50",children:i?(0,s.jsx)("div",{className:"w-10 h-10 border-2 border-primary-foreground border-t-transparent rounded-full animate-spin"}):l?(0,s.jsx)(eD.A,{className:"w-10 h-10"}):(0,s.jsx)(n.A,{className:"w-10 h-10 ml-1"})}),(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:b,className:"text-muted-foreground hover:text-foreground hover:bg-accent rounded-full w-14 h-14",children:(0,s.jsx)(eU.A,{className:"w-7 h-7"})}),(0,s.jsxs)(V,{variant:"ghost",size:"icon",onClick:N,className:"".concat("none"!==h?"text-foreground bg-accent/20 border border-accent/30":"text-muted-foreground"," hover:text-foreground hover:bg-accent/30 rounded-full w-12 h-12 border border-transparent hover:border-accent/20 transition-all"),children:[(0,s.jsx)(eO.A,{className:"w-6 h-6"}),"repeat"===h&&(0,s.jsx)("span",{className:"absolute text-[10px] font-bold",children:"1"})]})]})})]})]})})})]})}var eH=r(9771),eV=r(1040),eW=r(79600);function eQ(e){let{track:t,isPlaying:r,onPlayPause:l,onExpand:i,onNext:c,onPrevious:d,volume:u=1,onVolumeChange:x,isSidebarCollapsed:h=!1,onToggleLike:f,isLiked:p=!1,onShuffle:g,onRepeat:b,isShuffled:v=!1,repeatMode:j="none",onAddToPlaylist:y,currentTime:w=0,duration:k=0,onSeek:A}=e,{showMiniPlayer:C}=(0,eW.t)(),[S,P]=(0,a.useState)(!1),z=(0,a.useRef)(null),L=(0,a.useRef)(null),M=(0,a.useRef)(!1),[E,T]=(0,a.useState)(!1),I=(0,a.useCallback)(e=>{var t;e.preventDefault(),e.stopPropagation(),M.current=!0;let r=e=>{if(!M.current||!L.current||!x)return;let t=L.current.getBoundingClientRect(),r=t.height;x(Math.max(0,Math.min(1,1-(e.clientY-t.top)/r)))},s=()=>{M.current=!1,document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",s);let a=null===(t=L.current)||void 0===t?void 0:t.getBoundingClientRect();if(a&&x){let t=a.height;x(Math.max(0,Math.min(1,1-(e.clientY-a.top)/t)))}},[x]),O=(0,a.useCallback)(e=>{var t;if(e.stopPropagation(),M.current)return;let r=null===(t=L.current)||void 0===t?void 0:t.getBoundingClientRect();if(r&&x){let t=r.height;x(Math.max(0,Math.min(1,1-(e.clientY-r.top)/t)))}},[x]),R=e=>{if(isNaN(e)||!isFinite(e))return"0:00";let t=Math.floor(e/60),r=Math.floor(e%60);return"".concat(t,":").concat(r.toString().padStart(2,"0"))};return C?(0,s.jsx)(m.P.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},className:"fixed bottom-[80px] left-4 right-4 z-50 md:z-50 md:bottom-6 md:right-6 ".concat(h?"md:left-[104px]":"md:left-[272px]"),children:(0,s.jsxs)("div",{className:"glass-card p-3 md:p-4 backdrop-blur-md border border-border/20 rounded-2xl shadow-lg cursor-pointer relative overflow-visible bg-background/10",onClick:i,onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 md:space-x-4 relative",children:[(0,s.jsx)("div",{className:"w-12 h-12 md:w-14 md:h-14 bg-background/40 rounded-xl flex items-center justify-center flex-shrink-0 backdrop-blur-sm border border-border/30 overflow-hidden",children:t.coverArt?(0,s.jsx)("img",{src:t.coverArt,alt:t.title,className:"w-full h-full rounded-xl object-cover"}):(0,s.jsx)("div",{className:"w-6 h-6 md:w-7 md:h-7 bg-muted-foreground/20 rounded-full"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0 mr-4",children:[(0,s.jsx)("h3",{className:"text-foreground text-sm md:text-base font-medium truncate max-w-[120px] md:max-w-[200px]",children:t.title}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs md:text-sm truncate max-w-[120px] md:max-w-[200px]",children:t.artist})]}),(0,s.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2 top-1/2 -translate-y-1/2 z-10 hidden md:block",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[g&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),g()},className:"w-10 h-10 rounded-lg flex items-center justify-center transition-colors ".concat(v?"text-primary":"text-muted-foreground hover:text-foreground"),children:(0,s.jsx)(e_.A,{className:"w-5 h-5"})}),d&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),d()},className:"w-10 h-10 text-muted-foreground hover:text-foreground rounded-lg flex items-center justify-center transition-colors",children:(0,s.jsx)(eR.A,{className:"w-5 h-5"})}),(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),l()},className:"w-16 h-16 bg-primary text-primary-foreground rounded-full flex items-center justify-center hover:bg-primary/90 transition-colors shadow-lg",children:r?(0,s.jsx)(eD.A,{className:"w-8 h-8"}):(0,s.jsx)(n.A,{className:"w-8 h-8 ml-1"})}),c&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),c()},className:"w-10 h-10 text-muted-foreground hover:text-foreground rounded-lg flex items-center justify-center transition-colors",children:(0,s.jsx)(eU.A,{className:"w-5 h-5"})}),b&&(0,s.jsxs)("button",{onClick:e=>{e.stopPropagation(),b()},className:"w-10 h-10 rounded-lg flex items-center justify-center transition-colors ".concat("none"!==j?"text-primary":"text-muted-foreground hover:text-foreground"),children:[(0,s.jsx)(eO.A,{className:"w-5 h-5"}),"track"===j&&(0,s.jsx)("span",{className:"absolute text-[8px] font-bold",children:"1"})]})]})}),(0,s.jsxs)("div",{className:"md:hidden flex items-center gap-1 absolute right-0 top-1/2 -translate-y-1/2",children:[f&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),f()},className:"w-14 h-14 rounded-lg flex items-center justify-center transition-all duration-200 ".concat(p?"text-red-400 hover:text-red-300":"text-muted-foreground hover:text-foreground"),children:(0,s.jsx)(o.A,{className:"w-6 h-6 transition-all duration-200 ".concat(p?"fill-current":"")})}),(0,s.jsxs)("div",{className:"relative w-14 h-14",children:[(0,s.jsxs)("svg",{className:"absolute inset-0 w-full h-full -rotate-90",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"text-muted-foreground/20",strokeWidth:"1.5",stroke:"currentColor",fill:"transparent",r:"10",cx:"12",cy:"12"}),k>0&&w>=0&&(0,s.jsx)("circle",{className:"text-primary",strokeWidth:"1.5",strokeDasharray:2*Math.PI*10,strokeDashoffset:2*Math.PI*10*(1-Math.min(1,w/k)),strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"10",cx:"12",cy:"12"})]}),(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),l()},className:"absolute inset-0 flex items-center justify-center",children:r?(0,s.jsx)(eD.A,{className:"w-6 h-6 text-foreground"}):(0,s.jsx)(n.A,{className:"w-6 h-6 text-foreground ml-0.5"})})]})]}),(0,s.jsxs)("div",{className:"hidden md:flex items-center space-x-3 absolute right-4",children:[x&&(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-10 h-10 text-muted-foreground hover:text-foreground rounded-lg flex items-center justify-center transition-colors cursor-pointer",onMouseEnter:()=>{z.current&&clearTimeout(z.current),P(!0)},onMouseLeave:()=>{z.current=setTimeout(()=>{P(!1)},300)},onClick:e=>e.stopPropagation(),children:0===u?(0,s.jsx)(eH.A,{className:"w-5 h-5"}):u<.5?(0,s.jsx)(eV.A,{className:"w-5 h-5"}):(0,s.jsx)(N.A,{className:"w-5 h-5"})}),S&&(0,s.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 z-50",onMouseEnter:()=>{z.current&&clearTimeout(z.current),P(!0)},onMouseLeave:()=>{z.current=setTimeout(()=>{P(!1)},300)},onClick:e=>e.stopPropagation(),children:(0,s.jsx)("div",{className:"glass-card p-3 backdrop-blur-xl border border-border rounded-xl shadow-lg bg-card",children:(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,s.jsx)("div",{className:"text-muted-foreground mb-2",children:0===u?(0,s.jsx)(eH.A,{className:"h-4 w-4"}):u<.5?(0,s.jsx)(eV.A,{className:"h-4 w-4"}):(0,s.jsx)(N.A,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{ref:L,className:"relative h-32 w-1 bg-muted rounded-full cursor-pointer",onClick:O,onMouseDown:I,children:[(0,s.jsx)("div",{className:"absolute bottom-0 w-full bg-primary rounded-full transition-all duration-200",style:{height:"".concat(100*u,"%")}}),(0,s.jsx)("div",{className:"absolute w-3 h-3 bg-primary rounded-full -left-1 transition-all duration-200 cursor-pointer hover:scale-110 pointer-events-none shadow-lg",style:{bottom:"".concat(100*u,"%"),transform:"translateY(50%)"}})]}),(0,s.jsxs)("span",{className:"text-xs text-foreground font-medium",children:[Math.round(100*u),"%"]})]})})})]}),y&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),y()},className:"w-10 h-10 text-muted-foreground hover:text-foreground rounded-lg flex items-center justify-center transition-colors",title:"Добавить в плейлист",children:(0,s.jsx)(D.A,{className:"w-5 h-5"})}),f&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),f()},className:"w-10 h-10 rounded-lg flex items-center justify-center transition-all duration-200 ".concat(p?"text-red-400 hover:text-red-300":"text-muted-foreground hover:text-foreground"),children:(0,s.jsx)(o.A,{className:"w-5 h-5 transition-all duration-200 ".concat(p?"fill-current":"")})})]})]}),E&&A&&(0,s.jsx)(m.P.div,{className:"hidden md:block mt-4 px-4",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2,ease:"easeOut"},children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("span",{className:"text-muted-foreground text-xs whitespace-nowrap",children:R(w)}),(0,s.jsxs)("div",{className:"relative h-1.5 flex-1 bg-muted rounded-full cursor-pointer group",onClick:e=>{e.stopPropagation();let t=e.currentTarget.getBoundingClientRect();A((e.clientX-t.left)/t.width*(k||0))},onMouseDown:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"absolute top-0 left-0 h-full bg-primary rounded-full transition-all duration-200 group-hover:h-2",style:{width:"".concat(w/(k||1)*100,"%")}}),(0,s.jsx)("div",{className:"absolute top-1/2 w-2 h-2 bg-primary rounded-full -translate-y-1/2 -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none shadow-lg",style:{left:"".concat(w/(k||1)*100,"%")}})]}),(0,s.jsx)("span",{className:"text-muted-foreground text-xs whitespace-nowrap",children:R(k)})]})})]})}):null}var eJ=r(81702);function eK(e){var t;let{playlist:r,currentTrack:l,onTrackSelect:i,onBack:u,shuffle:x,onShuffleToggle:h,isLoading:f=!1,onDeletePlaylist:g,onUpdatePlaylist:b,onToggleFavorite:v,onAddToPlaylist:j,onDownloadTrack:y,favorites:N=[]}=e,[w,k]=(0,a.useState)({type:"track",isOpen:!1,x:0,y:0,item:null}),[A,C]=(0,a.useState)(!1),[S,P]=(0,a.useState)(null),{playlists:z,addPlaylist:L}=(0,eh.t)(),M=(0,eJ.l)(),[E,T]=(0,a.useState)(!1),O=z.some(e=>e.id===r.id),R=async()=>{try{if(O){alert("Этот плейлист уже есть в вашей библиотеке!");return}let e={...r,id:"library_".concat(Date.now())};L(e),M.success('Плейлист "'.concat(r.title,'" успешно добавлен в библиотеку!'))}catch(e){console.error("Ошибка при добавлении плейлиста в библиотеку:",e),M.error("Ошибка при добавлении плейлиста: "+(e instanceof Error?e.message:"Неизвестная ошибка"))}},U=r.tracks||[],_=(e,t,r)=>{e.preventDefault(),k({type:t,isOpen:!0,x:e.clientX,y:e.clientY,item:r})},F=()=>{k({type:"track",isOpen:!1,x:0,y:0,item:null})},B=e=>{try{eE(e)}catch(e){console.error("Ошибка при экспорте плейлиста:",e)}},H=e=>{P(e),C(!0)},W=e=>{confirm("Удалить плейлист? Это действие нельзя отменить.")&&g&&g(e.id)},Q=async e=>{if(S)try{b&&await b(S.id,{title:e})}catch(e){console.error("Ошибка при переименовании плейлиста:",e)}},J=async e=>{if(S)try{b&&await b(S.id,{coverArt:e})}catch(e){console.error("Ошибка при смене обложки плейлиста:",e)}},K=async()=>{if(S)try{b?await b(S.id,{coverArt:null}):console.log("Удаление обложки плейлиста:",S.id)}catch(e){console.error("Ошибка при удалении обложки плейлиста:",e)}};return(0,s.jsxs)("div",{className:"h-full bg-background text-foreground flex flex-col",children:[(0,s.jsxs)("div",{className:"flex-shrink-0 relative p-4 md:p-6",children:[(0,s.jsx)("div",{className:"hidden md:block absolute top-4 right-4 z-10",children:(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:u,className:"text-muted-foreground hover:text-foreground hover:bg-accent/50 rounded-full w-12 h-12 shadow-lg backdrop-blur-sm",children:(0,s.jsx)(p.A,{className:"w-6 h-6"})})}),(0,s.jsxs)("div",{className:"flex items-center justify-between md:hidden",children:[(0,s.jsx)("div",{className:"w-10"})," ",(0,s.jsx)("h1",{className:"text-sm font-semibold uppercase text-foreground/80",children:"Плейлист"}),(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:u,className:"text-muted-foreground hover:text-foreground hover:bg-accent/50 rounded-full w-10 h-10",children:(0,s.jsx)(p.A,{className:"w-5 h-5"})})]}),(0,s.jsx)("div",{className:"hidden md:flex justify-center",children:(0,s.jsx)("h1",{className:"text-lg font-bold uppercase text-foreground/90 bg-background/50 px-6 py-2 rounded-xl backdrop-blur-sm border border-border/30",children:"Плейлист"})})]}),(0,s.jsx)("div",{className:"flex-shrink-0 px-4 md:px-6 mb-4 md:mb-6",children:(0,s.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-32 h-32 md:w-40 md:h-40 lg:w-48 lg:h-48 rounded-xl flex items-center justify-center mr-6 flex-shrink-0",children:"favorites"===r.id||"Любимые"===r.title||(null===(t=r.title)||void 0===t?void 0:t.includes("Любимые"))?(0,s.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-red-500/20 to-red-600/30 rounded-xl flex items-center justify-center",children:(0,s.jsx)(o.A,{className:"w-16 h-16 md:w-20 md:h-20 lg:w-24 lg:h-24 text-red-500 fill-red-500"})}):r.coverArt?(0,s.jsx)("img",{src:r.coverArt,alt:r.title,className:"w-full h-full object-cover rounded-xl"}):(0,s.jsx)("div",{className:"w-full h-full bg-muted rounded-xl flex items-center justify-center",children:(0,s.jsx)(d.A,{className:"w-12 h-12 text-muted-foreground"})})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h2",{className:"text-2xl md:text-3xl lg:text-4xl font-bold tracking-tight text-foreground mb-1",children:r.title}),(0,s.jsx)("p",{className:"text-muted-foreground mt-1 text-base md:text-lg lg:text-xl",children:r.artist}),(0,s.jsxs)("p",{className:"text-sm md:text-base text-muted-foreground mt-2",children:[r.trackCount," tracks"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 ml-4",children:[(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:R,disabled:O,className:"w-10 h-10 md:w-12 md:h-12 rounded-full ".concat(O?"bg-transparent text-muted-foreground cursor-not-allowed opacity-50":"bg-transparent text-muted-foreground hover:text-foreground hover:bg-accent/50"),title:O?"Плейлист уже в библиотеке":"Добавить в библиотеку",children:(0,s.jsx)(D.A,{className:"w-5 h-5 md:w-6 md:h-6"})}),(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:h,className:"w-10 h-10 md:w-12 md:h-12 rounded-full ".concat(x?"bg-accent text-accent-foreground":"bg-transparent text-muted-foreground hover:text-foreground hover:bg-accent/50"),children:(0,s.jsx)(e_.A,{className:"w-5 h-5 md:w-6 md:h-6"})}),(0,s.jsx)(V,{size:"icon",className:"w-12 h-12 md:w-14 md:h-14 rounded-full bg-primary text-primary-foreground hover:bg-primary/90",onClick:()=>{r.tracks&&r.tracks.length>0&&i(r.tracks[0])},children:(0,s.jsx)(n.A,{className:"w-6 h-6 md:w-7 md:h-7 ml-0.5"})})]})]})}),(0,s.jsx)("div",{className:"flex-1 min-h-0",children:(0,s.jsx)(I,{className:"h-full px-4 md:px-6",children:(0,s.jsx)("div",{className:"pb-20 space-y-2",children:f?(0,s.jsxs)("div",{className:"space-y-2",children:[[...Array(8)].map((e,t)=>(0,s.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"flex items-center p-3 md:p-4 rounded-lg bg-accent/10 animate-pulse",children:[(0,s.jsx)("div",{className:"w-12 h-12 md:w-14 md:h-14 bg-accent/20 rounded-lg mr-3 md:mr-4"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"h-4 bg-accent/20 rounded-md mb-2 w-3/4"}),(0,s.jsx)("div",{className:"h-3 bg-accent/10 rounded-md w-1/2"})]})]},t)),(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Загрузка треков из плейлиста..."}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground/70 mt-1",children:"Получаем информацию о треках"})]})})]}):(0,s.jsx)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"space-y-1 pb-20",children:U.length>0?U.map((e,t)=>(0,s.jsxs)("div",{onClick:()=>i(e),onContextMenu:t=>_(t,"track",e),className:"flex items-center p-3 md:p-4 rounded-lg transition-colors cursor-pointer group ".concat((null==l?void 0:l.id)===e.id?"bg-accent/20 border border-accent/30":"hover:bg-accent/10"),children:[(0,s.jsx)("div",{className:"w-12 h-12 md:w-14 md:h-14 bg-muted rounded-lg flex items-center justify-center mr-3 md:mr-4 flex-shrink-0 overflow-hidden",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover"}):(0,s.jsx)(c.A,{className:"w-6 h-6 md:w-7 md:h-7 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-foreground text-sm md:text-base font-medium break-words leading-tight",children:e.title}),(0,s.jsxs)("p",{className:"text-muted-foreground text-xs md:text-sm break-words leading-tight",children:[e.artist," \xb7 ",e.duration]})]}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),i(e)},className:"opacity-0 group-hover:opacity-100 transition-opacity p-2 hover:bg-accent/50 rounded-full",children:(0,s.jsx)(n.A,{className:"w-4 h-4 md:w-5 md:h-5 text-foreground"})})]},e.id)):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(d.A,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground text-lg",children:"В плейлисте пока нет треков"})]})})})})}),w.isOpen&&w.item&&(0,s.jsxs)(s.Fragment,{children:["track"===w.type&&(0,s.jsx)(ej,{isOpen:w.isOpen,onClose:F,x:w.x,y:w.y,track:{...w.item,isLiked:(null==N?void 0:N.some(e=>e.id===w.item.id))||!1},onPlay:()=>{i(w.item),F()},onToggleLike:()=>{v?v(w.item.id):console.log("Toggle favorite for track:",w.item.id),F()},onAddToPlaylist:()=>{console.log("Add track to playlist:",w.item.id),F()},onDownload:()=>{y?y(w.item.id):console.log("Download track:",w.item.id),F()}}),"playlist"===w.type&&(0,s.jsx)(ey,{isOpen:w.isOpen,onClose:F,x:w.x,y:w.y,playlist:w.item,onPlay:()=>{var e;let t=null===(e=w.item.tracks)||void 0===e?void 0:e[0];t&&i(t),F()},onExport:()=>{B(w.item),F()},onEdit:()=>{H(w.item),F()},onDelete:()=>{W(w.item),F()}})]}),S&&(0,s.jsx)(eM,{isOpen:A,onClose:()=>{C(!1),P(null)},playlist:S,onRename:Q,onCoverChange:J,onCoverRemove:K})]})}var eq=r(57340),eX=r(38719),eY=r(2572);let eZ=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsxs)(eY.bL,{ref:t,className:(0,A.cn)("relative flex w-full touch-none select-none items-center",r),...a,children:[(0,s.jsx)(eY.CC,{className:"relative h-1 w-full grow overflow-hidden rounded-full bg-muted/30",children:(0,s.jsx)(eY.Q6,{className:"absolute h-full bg-primary"})}),(0,s.jsx)(eY.zi,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]})});eZ.displayName=eY.bL.displayName;var eG=r(13052);function e$(e){let{title:t,icon:r,children:l,defaultOpen:n=!1,className:i,isOpen:o,onToggle:c}=e,[d,x]=(0,a.useState)(n),h=void 0!==o?o:d;return(0,s.jsxs)("div",{className:(0,A.cn)("border-b border-border/50",i),children:[(0,s.jsxs)("button",{onClick:c||(()=>x(!d)),className:"w-full flex items-center justify-between p-4 hover:bg-accent/50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[r&&(0,s.jsx)("div",{className:"text-muted-foreground",children:r}),(0,s.jsx)("span",{className:"text-foreground font-medium",children:t})]}),(0,s.jsx)(m.P.div,{animate:{rotate:90*!!h},transition:{duration:.2},children:(0,s.jsx)(eG.A,{className:"w-4 h-4 text-muted-foreground"})})]}),(0,s.jsx)(u.N,{children:h&&(0,s.jsx)(m.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:(0,s.jsx)("div",{className:"px-4 pb-4 space-y-4",children:l})})})]})}var e0=r(14738),e1=r(69803),e2=r(85339),e4=r(54213),e3=r(381),e5=r(70257),e6=r(41658),e8=r(62098),e7=r(93509);let e9=[{id:"system",name:"Системная",icon:e0.A,description:"Следует настройкам системы"},{id:"light",name:"Светлая",icon:e8.A,description:"Классическая светлая тема"},{id:"dark",name:"Темная",icon:e7.A,description:"Современная темная тема"},{id:"track",name:"Под трек",icon:d.A,description:"Автоматическая тема под обложку трека"}];function te(){let{theme:e,setThemeMode:t}=(0,e6.DP)(),[r,l]=(0,a.useState)(!1),n=e9.find(t=>t.id===e)||e9[0];return(0,s.jsxs)(Q,{open:r,onOpenChange:l,children:[(0,s.jsx)(J,{asChild:!0,children:(0,s.jsx)(V,{variant:"outline",className:"w-full justify-between bg-background/50 backdrop-blur-sm border-border/50 hover:bg-background/80 p-4 h-16",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-xl bg-muted/50 border border-border/30 flex items-center justify-center",children:(0,s.jsx)(n.icon,{className:"w-6 h-6 text-foreground"})}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-foreground",children:n.name}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:n.description})]})]})})}),(0,s.jsx)(K,{align:"start",className:"w-72 p-2 max-h-96 overflow-y-auto",children:e9.map(r=>{let a=r.icon,n=e===r.id;return(0,s.jsxs)(q,{onClick:()=>{console.log("ThemeColorPicker: selecting theme:",r.id),t(r.id),l(!1)},className:(0,A.cn)("flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all duration-200",n?"bg-primary/10 text-primary border border-primary/20":"hover:bg-accent/50 hover:text-accent-foreground"),children:[(0,s.jsx)("div",{className:(0,A.cn)("w-10 h-10 rounded-lg bg-muted/50 border border-border/30 flex items-center justify-center transition-all duration-200",n&&"scale-110 border-primary/50 bg-primary/20"),children:(0,s.jsx)(a,{className:(0,A.cn)("w-5 h-5 transition-colors duration-200",n?"text-primary":"text-muted-foreground")})}),(0,s.jsxs)("div",{className:"flex-1 text-left",children:[(0,s.jsx)("div",{className:(0,A.cn)("text-sm font-medium transition-colors duration-200",n?"text-primary":"text-foreground"),children:r.name}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:r.description})]}),n&&(0,s.jsx)(eL.A,{className:"w-4 h-4 text-primary ml-2"})]},r.id)})})]})}function tt(e){let{isMobile:t=!1,isCollapsed:r=!1}=e,[l,i]=(0,a.useState)(!1),[o,c]=(0,a.useState)(""),[d,m]=(0,a.useState)("appearance"),[u,x]=(0,a.useState)(!1),[h,f]=(0,a.useState)(!1),[b,j]=(0,a.useState)(!1),[y,N]=(0,a.useState)(""),[k,C]=(0,a.useState)(""),[S,P]=(0,a.useState)(""),{clearAllCache:z}=(0,eh.t)(),{theme:L,toggleTheme:M,isDark:E,customBackground:T,setCustomBackground:I,backgroundBlur:O,setBackgroundBlur:R,backgroundDarkness:D,setBackgroundDarkness:U}=(0,e6.DP)(),{theme:_,setTheme:F,autoPlay:B,setAutoPlay:H,cacheTracks:W,setCacheTracks:Q,showMiniPlayer:J,setShowMiniPlayer:K,showNotifications:q,setShowNotifications:X,maxCacheSize:Y,setMaxCacheSize:$,clearCacheOlderThan:ee,setClearCacheOlderThan:et,clearAllCache:el,clearCacheByType:eo,getCacheInfo:ec,soundcloudToken:eu,setSoundcloudToken:ef,spotifyClientId:ep,setSpotifyClientId:eg,spotifyClientSecret:eb,setSpotifyClientSecret:ev,vkToken:ej,setVkToken:ey,validSoundcloudToken:ew,validSpotifyClientId:ek,validSpotifyClientSecret:eA,validVkToken:eC,checkServiceToken:eS,saveValidSoundcloudToken:eM,saveValidSpotifyTokens:eE,saveValidVkToken:eT,clearValidSoundcloudToken:eI,clearValidSpotifyTokens:eO,clearValidVkToken:eR}=(0,eW.t)(),eD=()=>{o.trim()&&(console.log("Setting custom background:",o),I(o.trim()),c(""))},eU=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["B","KB","MB","GB"][t]},e_=ec(),eF=e=>{m(d===e?null:e)},eB=async()=>{if(!eu.trim()){N("Введите токен SoundCloud");return}N(""),x(!0);try{let e=await eS("soundcloud",eu);e.isValid?(N(""),eM(eu)):N(e.message),ef("")}catch(e){N((null==e?void 0:e.message)||"Ошибка проверки токена"),ef("")}finally{x(!1)}},eH=async()=>{if(!ep.trim()||!eb.trim()){C("Введите Client ID и Client Secret");return}C(""),f(!0);try{let e="".concat(ep.trim(),":").concat(eb.trim()),t=await eS("spotify",e);t.isValid?(C(""),eE(ep.trim(),eb.trim())):C(t.message),eg(""),ev("")}catch(e){C((null==e?void 0:e.message)||"Ошибка проверки токена"),eg(""),ev("")}finally{f(!1)}},eV=async()=>{if(!ej.trim()){P("Введите токен VK");return}P(""),j(!0);try{let e=await eS("vk",ej);e.isValid?(P(""),eT(ej)):P(e.message),ey("")}catch(e){P((null==e?void 0:e.message)||"Ошибка проверки токена"),ey("")}finally{j(!1)}},eQ=(0,s.jsxs)("div",{className:"space-y-0",children:[(0,s.jsx)(e$,{title:"Внешний вид",icon:(0,s.jsx)(eP.A,{className:"w-4 h-4"}),isOpen:"appearance"===d,onToggle:()=>eF("appearance"),children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(te,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-foreground",children:"Кастомный фон"}),T&&(0,s.jsxs)("div",{className:"relative bg-muted rounded-xl p-4 border border-border",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Текущий фон"}),(0,s.jsx)(V,{variant:"ghost",size:"sm",onClick:()=>I(null),className:"text-muted-foreground hover:text-foreground",children:(0,s.jsx)(p.A,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"relative w-full h-32 rounded-lg overflow-hidden",children:[(0,s.jsx)("img",{src:T,alt:"Custom background",className:"w-full h-full object-cover"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/50",style:{backdropFilter:"blur(".concat(O,"px)"),backgroundColor:"rgba(0, 0, 0, ".concat(D/100,")")}})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(eN,{placeholder:"Введите URL изображения, гифки или видео...",value:o,onChange:e=>c(e.target.value),className:"flex-1",onKeyDown:e=>{"Enter"===e.key&&eD()}}),(0,s.jsx)(V,{variant:"outline",onClick:eD,disabled:!o.trim(),className:"px-4",children:(0,s.jsx)(ez.A,{className:"w-4 h-4"})})]}),(0,s.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"file",accept:"image/*,video/*",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&I(URL.createObjectURL(r))},className:"hidden"}),(0,s.jsx)(V,{variant:"outline",className:"w-full flex items-center space-x-2",asChild:!0,children:(0,s.jsxs)("span",{children:[(0,s.jsx)(ez.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Файл"})]})})]})]}),T&&(0,s.jsxs)("div",{className:"space-y-4 bg-muted rounded-xl p-4 border border-border",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-foreground",children:"Эффекты фона"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:"Размытие"}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[O,"px"]})]}),(0,s.jsx)(eZ,{value:[O],onValueChange:e=>R(e[0]),max:20,min:0,step:1,className:"w-full"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:"Затемнение"}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[D,"%"]})]}),(0,s.jsx)(eZ,{value:[D],onValueChange:e=>U(e[0]),max:80,min:0,step:1,className:"w-full"})]})]})]})]})}),(0,s.jsx)(e$,{title:"Интерфейс",icon:(0,s.jsx)(e0.A,{className:"w-4 h-4"}),isOpen:"interface"===d,onToggle:()=>eF("interface"),children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Мини-плеер"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Показывать мини-плеер внизу экрана"})]}),(0,s.jsx)(V,{variant:J?"default":"outline",size:"sm",onClick:()=>K(!J),children:J?"Включен":"Выключен"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Уведомления"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Показывать уведомления о действиях"})]}),(0,s.jsx)(V,{variant:q?"default":"outline",size:"sm",onClick:()=>X(!q),children:q?"Включены":"Выключены"})]})]})}),(0,s.jsx)(e$,{title:"Воспроизведение",icon:(0,s.jsx)(n.A,{className:"w-4 h-4"}),isOpen:"playback"===d,onToggle:()=>eF("playback"),children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Авто-плей"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Автоматически воспроизводить последний трек"})]}),(0,s.jsx)(V,{variant:B?"default":"outline",size:"sm",onClick:()=>H(!B),children:B?"Включен":"Выключен"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Кеширование треков"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Сохранять треки для офлайн воспроизведения"})]}),(0,s.jsx)(V,{variant:W?"default":"outline",size:"sm",onClick:()=>Q(!W),children:W?"Включено":"Выключено"})]})]})}),(0,s.jsx)(e$,{title:"Токены сервисов",icon:(0,s.jsx)(e1.A,{className:"w-4 h-4"}),isOpen:"tokens"===d,onToggle:()=>eF("tokens"),children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"p-4 rounded-xl bg-card/50 border border-border/30 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("div",{className:"p-2 bg-orange-500/10 rounded-lg border border-orange-500/20",children:(0,s.jsx)(v,{source:"soundcloud",size:20,isSelected:!0})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-foreground",children:"SoundCloud"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Client ID для доступа к API"})]})]}),ew?(0,s.jsxs)("div",{className:"flex items-center justify-between bg-primary/10 backdrop-blur-sm border border-primary/20 p-3 rounded-xl shadow-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(eL.A,{className:"h-4 w-4 text-primary"}),(0,s.jsx)("span",{className:"text-sm text-primary",children:"Токен сохранен"})]}),(0,s.jsx)(V,{size:"sm",variant:"outline",onClick:()=>{eI(),N("")},className:"h-8 px-2 text-xs backdrop-blur-sm bg-white/10 border-white/20 hover:bg-white/20",children:(0,s.jsx)(g.A,{className:"h-3 w-3"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(eN,{type:"password",placeholder:"Введите Client ID SoundCloud...",value:eu,onChange:e=>{ef(e.target.value),y&&N("")},className:"flex-1 h-10"}),(0,s.jsx)(V,{size:"sm",onClick:eB,disabled:!eu.trim()||u,variant:"outline",className:"h-10 px-3",children:u?(0,s.jsx)(w.A,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(eL.A,{className:"h-4 w-4"})})]}),y&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-destructive bg-destructive/10 p-2 rounded-md mt-2",children:[(0,s.jsx)(e2.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:y})]})]})]}),(0,s.jsxs)("div",{className:"p-4 rounded-xl bg-card/50 border border-border/30 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("div",{className:"p-2 bg-green-500/10 rounded-lg border border-green-500/20",children:(0,s.jsx)(v,{source:"spotify",size:20,isSelected:!0})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-foreground",children:"Spotify"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Client ID и Client Secret"})]})]}),ek||eA?(0,s.jsxs)("div",{className:"flex items-center justify-between bg-primary/10 backdrop-blur-sm border border-primary/20 p-3 rounded-xl shadow-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(eL.A,{className:"h-4 w-4 text-primary"}),(0,s.jsx)("span",{className:"text-sm text-primary",children:"Токены сохранены"})]}),(0,s.jsx)(V,{size:"sm",variant:"outline",onClick:()=>{eO(),C("")},className:"h-8 px-2 text-xs backdrop-blur-sm bg-white/10 border-white/20 hover:bg-white/20",children:(0,s.jsx)(g.A,{className:"h-3 w-3"})})]}):(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(eN,{type:"text",placeholder:"Client ID",value:ep,onChange:e=>{eg(e.target.value),k&&C("")},className:"w-full"}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(eN,{type:"password",placeholder:"Client Secret",value:eb,onChange:e=>{ev(e.target.value),k&&C("")},className:"flex-1 h-10"}),(0,s.jsx)(V,{size:"sm",onClick:eH,disabled:!ep.trim()||!eb.trim()||h,variant:"outline",className:"h-10 px-3",children:h?(0,s.jsx)(w.A,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(eL.A,{className:"h-4 w-4"})})]}),k&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-destructive bg-destructive/10 p-2 rounded-md",children:[(0,s.jsx)(e2.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:k})]})]})]}),(0,s.jsxs)("div",{className:"p-4 rounded-xl bg-card/50 border border-border/30 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("div",{className:"p-2 bg-blue-500/10 rounded-lg border border-blue-500/20",children:(0,s.jsx)(v,{source:"vk",size:20,isSelected:!0})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-foreground",children:"VK Music"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Токен доступа к VK API"})]})]}),eC?(0,s.jsxs)("div",{className:"flex items-center justify-between bg-primary/10 backdrop-blur-sm border border-primary/20 p-3 rounded-xl shadow-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(eL.A,{className:"h-4 w-4 text-primary"}),(0,s.jsx)("span",{className:"text-sm text-primary",children:"Токен сохранен"})]}),(0,s.jsx)(V,{size:"sm",variant:"outline",onClick:()=>{eR(),P("")},className:"h-8 px-2 text-xs backdrop-blur-sm bg-white/10 border-white/20 hover:bg-white/20",children:(0,s.jsx)(g.A,{className:"h-3 w-3"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(eN,{type:"password",placeholder:"Введите токен VK...",value:ej,onChange:e=>{ey(e.target.value),S&&P("")},className:"flex-1 h-10"}),(0,s.jsx)(V,{size:"sm",onClick:eV,disabled:!ej.trim()||b,variant:"outline",className:"h-10 px-3",children:b?(0,s.jsx)(w.A,{className:"h-4 w-4 animate-spin"}):(0,s.jsx)(eL.A,{className:"h-4 w-4"})})]}),S&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-destructive bg-destructive/10 p-2 rounded-md mt-2",children:[(0,s.jsx)(e2.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:S})]})]})]})]})}),(0,s.jsx)(e$,{title:"Хранилище",icon:(0,s.jsx)(e4.A,{className:"w-4 h-4"}),isOpen:"storage"===d,onToggle:()=>eF("storage"),children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-muted rounded-xl p-4 border border-border",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-foreground",children:"Всего"}),(0,s.jsx)("span",{className:"text-sm font-medium text-foreground",children:eU(e_.total)})]}),(0,s.jsx)("div",{className:"space-y-2",children:Object.entries(e_.byType).map(e=>{let[t,r]=e;return 0===r?null:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:{favorites:"Избранное",playlists:"Плейлисты",recent:"Недавние",tracks:"Треки",images:"Изображения",other:"Другое"}[t]||t}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:eU(r)}),(0,s.jsx)(V,{variant:"ghost",size:"sm",onClick:()=>eo(t),className:"h-6 px-2 text-xs",children:(0,s.jsx)(g.A,{className:"w-3 h-3"})})]})]},t)})}),(0,s.jsxs)(V,{variant:"outline",size:"sm",className:"w-full justify-start text-xs mt-3",onClick:()=>{confirm("Очистить весь кеш? Это удалит все сохраненные треки и плейлисты.")&&(z(),el())},children:[(0,s.jsx)(g.A,{className:"w-3 h-3 mr-2"}),"Очистить всё"]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-foreground",children:"Настройки кеша"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:"Максимальный размер кеша"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:eU(1048576*Y)})]}),(0,s.jsx)(eZ,{value:[Y],onValueChange:e=>$(e[0]),max:5120,min:512,step:512,className:"w-full"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:"Очищать кеш старше"}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[ee," дней"]})]}),(0,s.jsx)(eZ,{value:[ee],onValueChange:e=>et(e[0]),max:365,min:1,step:1,className:"w-full"})]})]})]})})]});return t?(0,s.jsxs)(Z,{open:l,onOpenChange:i,children:[(0,s.jsx)(G,{asChild:!0,children:(0,s.jsx)(V,{variant:"ghost",size:"icon",className:(0,A.cn)("w-10 h-10 rounded-full text-muted-foreground hover:text-foreground hover:bg-accent",r&&"w-10 h-10"),title:"Настройки",children:(0,s.jsx)(e3.A,{className:"w-5 h-5"})})}),(0,s.jsxs)(er,{className:"bg-background/95 backdrop-blur-xl border-t border-border max-h-[80vh]",children:[(0,s.jsx)(es,{className:"text-center",children:(0,s.jsxs)(ea,{className:"text-foreground flex items-center justify-center space-x-2",children:[(0,s.jsx)(e5.A,{className:"w-5 h-5 text-primary"}),(0,s.jsx)("span",{children:"Настройки"})]})}),(0,s.jsx)("div",{className:"overflow-y-auto px-4 pb-4",children:eQ})]})]}):(0,s.jsxs)(en,{open:l,onOpenChange:i,children:[(0,s.jsx)(ei,{asChild:!0,children:(0,s.jsxs)("button",{className:(0,A.cn)("flex items-center space-x-3 p-3 rounded-xl transition-all duration-200 w-full",r?"justify-center":"text-left","text-muted-foreground hover:text-foreground hover:bg-accent/50"),title:r?"Настройки":void 0,children:[(0,s.jsx)(e3.A,{className:"w-6 h-6"}),!r&&(0,s.jsx)("span",{className:"font-medium",children:"Настройки"})]})}),(0,s.jsxs)(ed,{className:"bg-background/95 backdrop-blur-xl border border-border max-w-2xl",children:[(0,s.jsx)(em,{className:"text-center",children:(0,s.jsxs)(ex,{className:"text-foreground flex items-center justify-center space-x-2",children:[(0,s.jsx)(e5.A,{className:"w-5 h-5 text-primary"}),(0,s.jsx)("span",{children:"Настройки"})]})}),eQ]})]})}var tr=r(81284),ts=r(71366),ta=r(33786),tl=r(17580),tn=r(34869);function ti(e){let{isMobile:t=!1,isCollapsed:r=!1}=e,[l,n]=(0,a.useState)(!1);if(r)return null;let i=(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-primary/20 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(tr.A,{className:"w-8 h-8 text-primary"})}),(0,s.jsx)("h3",{className:"text-xl font-bold text-foreground mb-2",children:"Dotify"}),(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:"v1.0.0"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-foreground",children:"Ссылки"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,s.jsxs)(V,{variant:"outline",className:"justify-start h-12",onClick:()=>window.open("https://t.me/nodotify","_blank"),children:[(0,s.jsx)(ts.A,{className:"w-5 h-5 mr-3 text-blue-500"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("div",{className:"font-medium",children:"Официальный Telegram"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Новости и поддержка"})]}),(0,s.jsx)(ta.A,{className:"w-4 h-4 ml-auto"})]}),(0,s.jsxs)(V,{variant:"outline",className:"justify-start h-12",onClick:()=>window.open("https://t.me/chatdotify","_blank"),children:[(0,s.jsx)(tl.A,{className:"w-5 h-5 mr-3 text-green-500"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("div",{className:"font-medium",children:"Чат сообщества"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Обсуждения и помощь"})]}),(0,s.jsx)(ta.A,{className:"w-4 h-4 ml-auto"})]}),(0,s.jsxs)(V,{variant:"outline",className:"justify-start h-12",onClick:()=>window.open("https://dotify.fun","_blank"),children:[(0,s.jsx)(tn.A,{className:"w-5 h-5 mr-3 text-purple-500"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("div",{className:"font-medium",children:"Официальный сайт"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"dotify.fun"})]}),(0,s.jsx)(ta.A,{className:"w-4 h-4 ml-auto"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-foreground",children:"Скачать приложение"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-2",children:(0,s.jsxs)(V,{variant:"outline",className:"justify-start h-12",onClick:()=>window.open("https://dotify.fun/download","_blank"),children:[(0,s.jsx)(_.A,{className:"w-5 h-5 mr-3 text-blue-500"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("div",{className:"font-medium",children:"Desktop версия"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Windows, macOS, Linux"})]}),(0,s.jsx)(ta.A,{className:"w-4 h-4 ml-auto"})]})})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-foreground",children:"Что нового?"}),(0,s.jsxs)("div",{className:"bg-muted/50 rounded-lg p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Новый функционал"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Плейлисты, настройки, поиск, любимые треик"})]})]}),(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Поддержка новых платформ"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"VK, Yandex"})]})]}),(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Экран загрузки, плеер, адаптивность"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Адаптивность под компьютеры и мобильные устройства"})]}),(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-foreground",children:"Установка, исправления открытия плейлистов убраны отступы"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Так же медия сессия"})]})]})]})]})]})]});return t?(0,s.jsxs)(Z,{open:l,onOpenChange:n,children:[(0,s.jsx)(G,{asChild:!0,children:(0,s.jsx)(V,{variant:"ghost",size:"icon",className:(0,A.cn)("w-10 h-10 rounded-full text-muted-foreground hover:text-foreground hover:bg-accent",r&&"w-10 h-10"),title:"О приложении",children:(0,s.jsx)(tr.A,{className:"w-5 h-5"})})}),(0,s.jsxs)(er,{className:"bg-background/95 backdrop-blur-xl border-t border-border max-h-[80vh]",children:[(0,s.jsx)(es,{className:"text-center",children:(0,s.jsxs)(ea,{className:"text-foreground flex items-center justify-center space-x-2",children:[(0,s.jsx)(tr.A,{className:"w-5 h-5 text-primary"}),(0,s.jsx)("span",{children:"О приложении"})]})}),(0,s.jsx)("div",{className:"overflow-y-auto px-4 pb-4",children:i})]})]}):(0,s.jsxs)(en,{open:l,onOpenChange:n,children:[(0,s.jsx)(ei,{asChild:!0,children:(0,s.jsx)(V,{variant:"ghost",size:"icon",className:(0,A.cn)("w-10 h-10 rounded-full text-muted-foreground hover:text-foreground hover:bg-accent",r&&"w-10 h-10"),title:"О приложении",children:(0,s.jsx)(tr.A,{className:"w-5 h-5"})})}),(0,s.jsxs)(ed,{className:"bg-background/95 backdrop-blur-xl border border-border max-w-2xl",children:[(0,s.jsx)(em,{className:"text-center",children:(0,s.jsxs)(ex,{className:"text-foreground flex items-center justify-center space-x-2",children:[(0,s.jsx)(tr.A,{className:"w-5 h-5 text-primary"}),(0,s.jsx)("span",{children:"О приложении"})]})}),i]})]})}function to(e){let{activeTab:t,onTabChange:r}=e,[l,n]=(0,a.useState)(!1),i=[{id:"home",icon:eq.A},{id:"search",icon:f.A},{id:"library",icon:d.A}],o=e=>{r(e),n(!1)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(m.P.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},className:"fixed bottom-2 left-4 right-4 z-50 md:hidden pointer-events-auto",children:(0,s.jsx)(m.P.div,{animate:{height:l?"auto":"64px"},className:"glass-card backdrop-blur-xl border border-border rounded-2xl shadow-2xl shadow-black/40 overflow-hidden",children:(0,s.jsx)("div",{className:"p-2",children:(0,s.jsx)("nav",{className:"flex justify-around items-center",children:i.map(e=>(0,s.jsx)("button",{onClick:()=>o(e.id),className:(0,A.cn)("relative flex items-center justify-center p-3 rounded-xl transition-all duration-200",t===e.id?"text-foreground bg-primary/20 border border-primary/30 shadow-lg scale-105 backdrop-blur-sm":"text-muted-foreground hover:text-foreground hover:bg-accent/50"),children:(0,s.jsx)(e.icon,{className:(0,A.cn)("w-6 h-6 transition-all duration-200",t===e.id?"scale-110":"")})},e.id))})})})})})}function tc(e){let{activeTab:t,onTabChange:r,collapsed:l=!1,onCollapsedChange:n,onPlaylistSelect:i,onPlayPlaylist:d,currentPlaylist:u}=e,{playlists:x,favorites:p,removePlaylist:g,updatePlaylist:b}=(0,eh.t)(),[v,j]=(0,a.useState)(l),[y,N]=(0,a.useState)(!1),[w,k]=(0,a.useState)(0),[C,S]=(0,a.useState)(256),[P,z]=(0,a.useState)({isOpen:!1,x:0,y:0,playlist:null}),[L,M]=(0,a.useState)(!1),[E,T]=(0,a.useState)(null);(0,a.useEffect)(()=>{j(l)},[l]);let I=e=>{j(e),null==n||n(e)},O=async e=>{if(E)try{b(E.id,{title:e}),console.log("DesktopNavigation: Плейлист переименован:",E.id,"в",e)}catch(e){console.error("DesktopNavigation: Ошибка при переименовании плейлиста:",e)}},R=async e=>{if(E)try{b(E.id,{coverArt:e}),console.log("DesktopNavigation: Обложка плейлиста изменена:",E.id,"на",e)}catch(e){console.error("DesktopNavigation: Ошибка при смене обложки плейлиста:",e)}},D=async()=>{if(E)try{b(E.id,{coverArt:null}),console.log("DesktopNavigation: Обложка плейлиста удалена:",E.id)}catch(e){console.error("DesktopNavigation: Ошибка при удалении обложки плейлиста:",e)}},U=e=>{try{eE(e)}catch(e){console.error("Ошибка при экспорте плейлиста:",e)}},_=e=>{y&&(120>=Math.max(80,Math.min(400,C+(e.clientX-w)))?v||I(!0):v&&I(!1))},F=()=>{N(!1),document.body.style.cursor="",document.body.style.userSelect=""},B=(e,t)=>{e.preventDefault(),z({isOpen:!0,x:e.clientX,y:e.clientY,playlist:t})},H=()=>{z({isOpen:!1,x:0,y:0,playlist:null})};return(0,a.useEffect)(()=>{if(y)return document.addEventListener("mousemove",_),document.addEventListener("mouseup",F),()=>{document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",F)}},[y,w,C]),(0,s.jsxs)(m.P.div,{initial:{width:v?80:256},animate:{width:v?80:256},transition:{duration:.3,ease:"easeInOut"},className:"hidden md:block fixed left-0 top-0 h-full z-40 pointer-events-auto",children:[(0,s.jsxs)("div",{className:"h-full bg-background/20 backdrop-blur-sm border-r border-border/50 shadow-2xl p-4 relative",children:[(0,s.jsx)("div",{className:"absolute -right-1 top-0 bottom-0 w-2 cursor-col-resize hover:bg-accent transition-colors z-50",onMouseDown:e=>{N(!0),k(e.clientX),S(v?80:256),document.body.style.cursor="col-resize",document.body.style.userSelect="none"}}),(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:(0,A.cn)("mb-4",v&&"mb-2"),children:[(0,s.jsxs)("div",{className:(0,A.cn)("flex items-center rounded-xl transition-all duration-200 w-full",v?"justify-center":"text-left space-x-3"),children:[(0,s.jsx)(h,{size:v?56:48,className:"opacity-90"},v?"collapsed":"expanded"),!v&&(0,s.jsx)(m.P.h1,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-2xl font-bold text-foreground",children:"Dotify"}),(0,s.jsx)("div",{className:"ml-auto",children:(0,s.jsx)(ti,{isMobile:!1,isCollapsed:v})})]}),(0,s.jsx)("div",{className:(0,A.cn)("h-px bg-border mt-2",v&&"mx-4")})]}),(0,s.jsxs)("nav",{className:"flex flex-col space-y-2",children:[(0,s.jsxs)("button",{onClick:()=>r("home"),className:(0,A.cn)("flex items-center p-3 rounded-xl transition-all duration-200 w-full",v?"justify-center":"text-left space-x-3","home"===t?"bg-primary/20 backdrop-blur-sm border border-primary/30 text-foreground shadow-lg":"text-muted-foreground hover:text-foreground hover:bg-accent/50"),title:v?"Главная":void 0,children:[(0,s.jsx)(eq.A,{className:"w-6 h-6"}),!v&&(0,s.jsx)("span",{className:"font-medium",children:"Главная"})]}),(0,s.jsxs)("button",{onClick:()=>r("search"),className:(0,A.cn)("flex items-center p-3 rounded-xl transition-all duration-200 w-full",v?"justify-center":"text-left space-x-3","search"===t?"bg-primary/20 backdrop-blur-sm border border-primary/30 text-foreground shadow-lg":"text-muted-foreground hover:text-foreground hover:bg-accent/50"),title:v?"Поиск":void 0,children:[(0,s.jsx)(f.A,{className:"w-6 h-6"}),!v&&(0,s.jsx)("span",{className:"font-medium",children:"Поиск"})]}),(0,s.jsxs)("button",{onClick:()=>{r("library"),null==i||i(null)},className:(0,A.cn)("flex items-center p-3 rounded-xl transition-all duration-200 w-full",v?"justify-center":"text-left space-x-3","library"!==t||u?"text-muted-foreground hover:text-foreground hover:bg-accent/50":"bg-primary/20 backdrop-blur-sm border border-primary/30 text-foreground shadow-lg"),title:v?"Ваша библиотека":void 0,children:[(0,s.jsx)(eX.A,{className:"w-6 h-6"}),!v&&(0,s.jsx)("span",{className:"font-medium",children:"Ваша библиотека"})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:(0,A.cn)("h-px bg-border mb-2",v&&"mx-4")}),(0,s.jsxs)("button",{onClick:()=>null==i?void 0:i({id:"favorites",title:"Любимые",artist:"Пользователь",trackCount:(null==p?void 0:p.length)||0,duration:"0:00",coverArt:null,tracks:p||[]}),onContextMenu:e=>B(e,{id:"favorites",title:"Любимые",artist:"Пользователь",trackCount:(null==p?void 0:p.length)||0,duration:"0:00",coverArt:null,tracks:p||[]}),className:(0,A.cn)("flex items-center p-3 rounded-xl transition-all duration-200 w-full",v?"justify-center":"text-left space-x-3",(null==u?void 0:u.id)==="favorites"?"bg-red-500/20 backdrop-blur-sm border border-red-500/30 text-red-500":"text-red-400 hover:text-red-300 hover:bg-red-500/10"),title:v?"Любимые":void 0,children:[(0,s.jsx)(o.A,{className:"w-6 h-6"}),!v&&(0,s.jsx)("span",{className:"font-medium",children:"Любимые"})]}),x.length>0&&(0,s.jsx)(s.Fragment,{children:x.slice(0,5).map(e=>(0,s.jsxs)("button",{onClick:()=>null==i?void 0:i(e),onContextMenu:t=>B(t,e),className:(0,A.cn)("flex items-center space-x-3 p-3 rounded-xl transition-all duration-200 w-full",v?"justify-center":"text-left",(null==u?void 0:u.id)===e.id?"bg-accent/20 backdrop-blur-sm border border-accent/30 text-foreground":"text-muted-foreground hover:text-foreground hover:bg-accent/50"),title:v?e.title:void 0,children:[(0,s.jsx)("div",{className:"w-6 h-6 bg-muted rounded-md flex items-center justify-center overflow-hidden flex-shrink-0",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover rounded-md"}):(0,s.jsx)(c.A,{className:"w-4 h-4"})}),!v&&(0,s.jsx)("span",{className:"font-medium truncate",children:e.title})]},e.id))})]})]}),(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsx)(tt,{isMobile:!1,isCollapsed:v})})]})]}),P.isOpen&&P.playlist&&(0,s.jsx)(ey,{isOpen:P.isOpen,onClose:H,x:P.x,y:P.y,playlist:P.playlist,onPlay:()=>{null==d||d(P.playlist),H()},onExport:()=>{U(P.playlist),H()},onEdit:()=>{T(P.playlist),M(!0),H()},onDelete:()=>{var e;(null===(e=P.playlist)||void 0===e?void 0:e.id)!=="favorites"&&(console.log("DesktopNavigation: Удаляем плейлист:",P.playlist.id),g(P.playlist.id)),H()}}),E&&(0,s.jsx)(eM,{isOpen:L,onClose:()=>{M(!1),T(null)},playlist:E,onRename:O,onCoverChange:R,onCoverRemove:D})]})}var td=r(27461),tm=r(14259),tu=r(67907),tx=r(65674),th=r(42481),tf=r(96056),tp=r(57395),tg=r(37369),tb=r(62067),tv=r(33061),tj=r(56287),ty=r(38164),tN=r(57434);function tw(e){let{isOpen:t,onClose:r,onImport:l}=e,[n,i]=(0,a.useState)(""),[o,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(""),[u,x]=(0,a.useState)("url"),[h,f]=(0,a.useState)(null),[g,b]=(0,a.useState)(null),v=async()=>{if(console.log("handleImport called, activeTab:",u,"url:",n,"playlistData:",g),"url"===u){if(n.trim()){c(!0),m("");try{console.log("Importing from URL:",n.trim()),await l(n.trim()),r(),i("")}catch(e){console.error("URL import error:",e),m(e instanceof Error?e.message:"Ошибка при импорте плейлиста")}finally{c(!1)}}}else if("json"===u){if(!g){console.log("No playlist data for JSON import");return}c(!0),m("");try{console.log("Importing from JSON:",g),console.log("Calling onImport with data type:",typeof g),await l(g),console.log("JSON import successful"),r(),b(null),f(null)}catch(e){console.error("JSON import error:",e),m(e instanceof Error?e.message:"Ошибка при импорте плейлиста")}finally{c(!1)}}};return(0,s.jsx)(en,{open:t,onOpenChange:r,children:(0,s.jsxs)(ed,{className:"bg-gradient-to-br from-background via-background/95 to-background/90 backdrop-blur-xl border border-border/50 max-w-2xl shadow-2xl",children:[(0,s.jsx)(em,{className:"text-center",children:(0,s.jsxs)(ex,{className:"text-foreground flex items-center justify-center space-x-2 text-xl font-bold",children:[(0,s.jsx)(tv.A,{className:"w-6 h-6 text-primary"}),(0,s.jsx)("span",{children:"Импорт плейлиста"})]})}),(0,s.jsxs)(ek,{value:u,onValueChange:x,className:"w-full",children:[(0,s.jsxs)(eA,{className:"grid w-full grid-cols-2 bg-muted/30 backdrop-blur-sm border border-border/30",children:[(0,s.jsxs)(eC,{value:"url",className:"flex items-center gap-2 data-[state=active]:bg-primary/20 data-[state=active]:text-primary",children:[(0,s.jsx)(ty.A,{className:"w-4 h-4"}),"По ссылке"]}),(0,s.jsxs)(eC,{value:"json",className:"flex items-center gap-2 data-[state=active]:bg-primary/20 data-[state=active]:text-primary",children:[(0,s.jsx)(tN.A,{className:"w-4 h-4"}),"Из JSON"]})]}),(0,s.jsx)(eS,{value:"url",className:"space-y-4 mt-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Ссылка на плейлист"}),(0,s.jsx)(eN,{value:n,onChange:e=>{i(e.target.value),d&&m("")},onKeyPress:e=>{"Enter"===e.key&&v()},placeholder:"https://soundcloud.com/playlist/...",className:"bg-input border-border text-foreground",autoFocus:!0}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Поддерживаются: SoundCloud, Spotify, VK, Yandex.Music"})]})}),(0,s.jsxs)(eS,{value:"json",className:"space-y-4 mt-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Выберите JSON файл"}),(0,s.jsxs)(V,{variant:"outline",onClick:()=>{var e;return null===(e=document.getElementById("json-file-input"))||void 0===e?void 0:e.click()},className:"w-full justify-center gap-2",children:[(0,s.jsx)(ez.A,{className:"w-4 h-4"}),h?h.name:"Выбрать файл"]}),(0,s.jsx)("input",{id:"json-file-input",type:"file",accept:".json",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){console.log("File selected:",r.name,"size:",r.size),f(r);let e=new FileReader;e.onload=e=>{try{var t;let r=null===(t=e.target)||void 0===t?void 0:t.result;console.log("File content:",r.substring(0,200)+"...");let s=eT(r);console.log("Parsed playlist data:",s),b(s),m("")}catch(e){console.error("File parsing error:",e),m(e instanceof Error?e.message:"Неверный формат файла"),b(null)}},e.readAsText(r)}},className:"hidden"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Поддерживаются файлы экспортированных плейлистов"})]}),g&&(0,s.jsxs)("div",{className:"bg-muted/50 rounded-lg p-3 border border-border",children:[(0,s.jsx)("h4",{className:"font-medium text-foreground mb-2",children:"Предпросмотр:"}),(0,s.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Название:"})," ",g.title]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Исполнитель:"})," ",g.artist||"Не указан"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Треков:"})," ",g.trackCount||0]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Дата экспорта:"})," ",new Date(g.exportDate).toLocaleDateString()]})]})]})]})]}),d&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 p-3 bg-destructive/10 border border-destructive/20 rounded-lg",children:[(0,s.jsx)(e2.A,{className:"w-4 h-4 text-destructive"}),(0,s.jsx)("span",{className:"text-sm text-destructive",children:d})]}),(0,s.jsxs)(eu,{className:"flex justify-center space-x-3 mt-6",children:[(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:r,className:"w-12 h-12 rounded-2xl text-muted-foreground hover:text-foreground hover:bg-accent/20 border border-border/30 hover:border-accent/30 transition-all duration-200",title:"Отмена",children:(0,s.jsx)(p.A,{className:"w-5 h-5"})}),(0,s.jsx)(V,{size:"icon",onClick:v,disabled:"url"===u?!n.trim():!g||o,className:"w-12 h-12 rounded-2xl bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70 text-primary-foreground shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50",title:"Импортировать",children:o?(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-primary-foreground/30 border-t-primary-foreground rounded-full animate-spin"}):(0,s.jsx)(eL.A,{className:"w-5 h-5"})})]})]})})}var tk=r(66196);function tA(e){let{onTrackSelect:t,onPlaylistSelect:r,currentTrack:i,isPlaying:u,currentPlaylist:x,onToggleShuffle:h}=e,[b,j]=(0,a.useState)("playlists"),[y,N]=(0,a.useState)(""),[w,k]=(0,a.useState)("default"),[C,S]=(0,a.useState)("list"),[P,z]=(0,a.useState)(x||null),[M,E]=(0,a.useState)(!1),[T,O]=(0,a.useState)(""),[R,U]=(0,a.useState)(null),[_,B]=(0,a.useState)(""),[H,W]=(0,a.useState)("music"),[X,Y]=(0,a.useState)(""),[Z,G]=(0,a.useState)(""),[$,ee]=(0,a.useState)(!1),[et,er]=(0,a.useState)(!1),[es,ea]=(0,a.useState)(null),[el,eo]=(0,a.useState)(!1),[ec,ef]=(0,a.useState)(null),[ep,eg]=(0,a.useState)(!1),[eb,ev]=(0,a.useState)({isOpen:!1,x:0,y:0,playlist:null}),{favorites:ej,playlists:ew,recentTracks:ek,isLoading:eA,toggleFavorite:eC,addPlaylist:eS,updatePlaylist:eP,removePlaylist:eI,addTrackToPlaylist:eO,removeTrackFromPlaylist:eR}=(0,eh.t)(),eD=async e=>{if(ec)try{await eP(ec.id,{title:e}),(null==P?void 0:P.id)===ec.id&&z({...P,title:e}),ef({...ec,title:e})}catch(e){console.error("Ошибка при переименовании плейлиста:",e)}},eU=async e=>{if(ec)try{await eP(ec.id,{coverArt:e}),(null==P?void 0:P.id)===ec.id&&z({...P,coverArt:e}),ef({...ec,coverArt:e})}catch(e){console.error("Ошибка при смене обложки плейлиста:",e)}},eF=async()=>{if(ec)try{await eP(ec.id,{coverArt:null}),(null==P?void 0:P.id)===ec.id&&z({...P,coverArt:null}),ef({...ec,coverArt:null})}catch(e){console.error("Ошибка при удалении обложки плейлиста:",e)}},eB=e=>{try{eE(e)}catch(e){console.error("Ошибка при экспорте плейлиста:",e)}},eH=async e=>{ee(!0),G("");try{let t=await tk.Q.importPlaylist(e);t.success&&t.playlist?(await eS(t.playlist),eg(!1),Y("")):t.error&&G(t.error)}catch(e){G(e instanceof Error?e.message:"Ошибка при импорте плейлиста")}finally{ee(!1)}},eV=async e=>{ee(!0),G("");try{let t=await e.text(),r=eT(t),s={id:"imported_".concat(Date.now()),title:r.title,artist:r.artist||"Неизвестный исполнитель",trackCount:r.trackCount,duration:r.duration,coverArt:r.coverArt||null,tracks:r.tracks.map(e=>({id:e.id,title:e.title,artist:e.artist,duration:e.duration,durationString:e.duration,source:e.source,streamable:!1,originalId:e.id,coverArt:e.coverArt||null,liked:!1,url:e.url||""}))};await eS(s),eg(!1)}catch(e){G(e instanceof Error?e.message:"Ошибка при импорте файла")}finally{ee(!1)}},eW=[{id:"music",icon:d.A,label:"Музыка"},{id:"list-music",icon:c.A,label:"Список"},{id:"disc",icon:td.A,label:"Диск"},{id:"radio",icon:tm.A,label:"Радио"},{id:"mic",icon:tu.A,label:"Микрофон"},{id:"guitar",icon:tx.A,label:"Гитара"},{id:"piano",icon:th.A,label:"Пианино"},{id:"drum",icon:tf.A,label:"Барабаны"},{id:"headphones",icon:tp.A,label:"Наушники"},{id:"speaker",icon:tg.A,label:"Колонки"},{id:"album",icon:tb.A,label:"Альбом"}],eQ=[(0,a.useMemo)(()=>({id:"favorites",title:"Любимые",artist:"Пользователь",trackCount:ej.length,duration:"0:00",coverArt:null,tracks:ej}),[ej]),...ew];(0,a.useEffect)(()=>{z(x||null)},[x]);let eJ=(e,t)=>{let r=[...e];switch(t){case"title_asc":return r.sort((e,t)=>e.title.localeCompare(t.title));case"title_desc":return r.sort((e,t)=>t.title.localeCompare(e.title));case"artist_asc":return r.sort((e,t)=>e.artist.localeCompare(t.artist));case"artist_desc":return r.sort((e,t)=>t.artist.localeCompare(e.artist));case"duration_asc":return r.sort((e,t)=>("number"==typeof e.duration?e.duration:0)-("number"==typeof t.duration?t.duration:0));case"duration_desc":return r.sort((e,t)=>{let r="number"==typeof e.duration?e.duration:0;return("number"==typeof t.duration?t.duration:0)-r});case"added_asc":return r.sort((e,t)=>(e.addedAt||0)-(t.addedAt||0));case"added_desc":return r.sort((e,t)=>(t.addedAt||0)-(e.addedAt||0));default:return r}},eK=e=>y?e.filter(e=>e.title.toLowerCase().includes(y.toLowerCase())||e.artist.toLowerCase().includes(y.toLowerCase())):e,eq=e=>y?e.filter(e=>e.title.toLowerCase().includes(y.toLowerCase())||e.artist&&e.artist.toLowerCase().includes(y.toLowerCase())):e,eX=(0,a.useMemo)(()=>eJ(eK(ej),w),[ej,y,w]),eY=(0,a.useMemo)(()=>eq(eQ),[eQ,y]);(0,a.useMemo)(()=>eJ(eK(ek),w),[ek,y,w]);let eZ=(0,a.useMemo)(()=>(null==P?void 0:P.tracks)?eJ(eK(P.tracks),w):[],[P,y,w]),eG=async()=>{if(T.trim()){let e=null;if(es)try{e=await e6(es)}catch(e){console.error("Error converting cover to base64:",e),alert("Ошибка при обработке обложки");return}let t={id:"playlist_".concat(Date.now()),title:T.trim(),artist:"Локальный плейлист",tracks:[],trackCount:0,duration:"0:00",coverArt:e,icon:H};await eS(t),O(""),W("music"),ea(null),E(!1)}},e$=e=>{if(!R){if("favorites"===e.id){let t={...e,tracks:ej};console.log("LibraryView: Открываем плейлист любимых:",t),z(t)}else console.log("LibraryView: Открываем плейлист:",e),z(e)}},e0=(e,t)=>{e.preventDefault(),ev({isOpen:!0,x:e.clientX,y:e.clientY,playlist:t})},e1=()=>{ev({isOpen:!1,x:0,y:0,playlist:null})},e2=e=>{U(e.id),B(e.title),W(e.icon||"music")},e4=async()=>{R&&_.trim()&&(await eP(R,{title:_.trim(),icon:H}),U(null),B(""),W("music"),(null==P?void 0:P.id)===R&&z(e=>e?{...e,title:_.trim(),icon:H}:null))},e3=async e=>{confirm("Удалить плейлист? Это действие нельзя отменить.")&&(await eI(e),(null==P?void 0:P.id)===e&&z(null))},e5=async(e,t)=>{er(!0);try{let r=await e6(t);await eP(e.id,{coverArt:r,icon:e.icon}),(null==P?void 0:P.id)===e.id&&z(e=>e?{...e,coverArt:r}:null),ew.map(t=>t.id===e.id?{...t,coverArt:r}:t)}catch(e){console.error("Error uploading cover:",e),alert("Ошибка при загрузке обложки")}finally{er(!1)}},e6=e=>new Promise((t,r)=>{let s=new FileReader;s.onload=()=>{"string"==typeof s.result?t(s.result):r(Error("Failed to convert file to base64"))},s.onerror=()=>r(Error("Failed to read file")),s.readAsDataURL(e)}),e8=async e=>{try{await eP(e.id,{coverArt:null,icon:e.icon}),(null==P?void 0:P.id)===e.id&&z(e=>e?{...e,coverArt:null}:null),ew.map(t=>t.id===e.id?{...t,coverArt:null}:t)}catch(e){console.error("Error removing cover:",e),alert("Ошибка при удалении обложки")}},e7=e=>{"favorites"===e.id?ej.length>0&&t(ej[0]):e.tracks&&e.tracks.length>0&&t(e.tracks[0])},e9=e=>{h&&h(),"favorites"===e.id?ej.length>0&&t([...ej].sort(()=>Math.random()-.5)[0]):e.tracks&&e.tracks.length>0&&t([...e.tracks].sort(()=>Math.random()-.5)[0])};if(eA)return(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})});if(P){var te,tt;return(0,s.jsxs)("div",{className:"flex flex-col h-full text-foreground relative",children:[P.coverArt&&(0,s.jsxs)("div",{className:"absolute inset-0 z-0",children:[(0,s.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"url(".concat(P.coverArt,")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",filter:"blur(20px) brightness(0.3)"}}),(0,s.jsx)("div",{className:"absolute inset-0 bg-background/80"})]}),(0,s.jsxs)("div",{className:"relative z-10 flex flex-col h-full",children:[(0,s.jsx)("div",{className:"p-4 md:p-6 space-y-6",children:(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-6",children:[(0,s.jsxs)("div",{className:"w-64 h-64 md:w-80 md:h-80 rounded-2xl flex items-center justify-center flex-shrink-0 overflow-hidden shadow-2xl relative",children:["favorites"===P.id||"Любимые"===P.title||(null===(te=P.title)||void 0===te?void 0:te.includes("Любимые"))?(0,s.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-red-500/20 to-red-600/30 rounded-2xl flex items-center justify-center",children:(0,s.jsx)(o.A,{className:"w-24 h-24 text-red-500 fill-red-500"})}):P.coverArt?(0,s.jsx)("img",{src:P.coverArt,alt:P.title,className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-primary/20 to-primary/10 rounded-2xl flex items-center justify-center",children:(0,s.jsx)(d.A,{className:"w-24 h-24 text-primary"})}),(0,s.jsx)("button",{onClick:()=>z(null),className:"absolute top-3 right-3 w-8 h-8 bg-background/50 hover:bg-background/70 text-foreground rounded-full flex items-center justify-center transition-all duration-200 hover:scale-110",children:(0,s.jsx)(p.A,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"text-center space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-foreground mb-2",children:P.title}),(0,s.jsxs)("p",{className:"text-muted-foreground text-base",children:[(null===(tt=P.tracks)||void 0===tt?void 0:tt.length)||0," треков"]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,s.jsxs)(V,{onClick:()=>e7(P),className:"bg-primary hover:bg-primary/90 text-primary-foreground font-semibold px-6 py-2.5 rounded-xl text-base shadow-lg transition-all duration-200 hover:scale-105",children:[(0,s.jsx)(n.A,{className:"w-5 h-5 mr-2"}),"Воспроизвести"]}),(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:()=>e9(P),className:"w-9 h-9 bg-muted hover:bg-accent text-foreground rounded-lg transition-all duration-200",title:"Перемешать",children:(0,s.jsx)(e_.A,{className:"w-4 h-4"})})]})]})]})}),(0,s.jsxs)("div",{className:"flex-1 min-h-0 px-4 md:px-6 pb-20",children:[(0,s.jsx)("div",{className:"h-px bg-border mb-6 mr-4 md:mr-6 ml-0"}),(0,s.jsx)(I,{className:"h-full",children:0===eZ.length?(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)(L,{variant:y?"search":"playlist",title:y?"Треки не найдены":"Плейлист пуст",subtitle:y?"Попробуйте другой поисковый запрос":"Добавьте треки в плейлист",className:"md:scale-110"})}):(0,s.jsx)("div",{className:"space-y-2",children:eZ.map((e,r)=>(0,s.jsxs)("div",{className:"flex items-center p-3 rounded-lg hover:bg-accent transition-colors group cursor-pointer ".concat((null==i?void 0:i.id)===e.id?"bg-primary/10":""),onClick:()=>t(e),children:[(0,s.jsxs)("div",{className:"hidden md:flex w-12 items-center justify-center mr-3 text-muted-foreground group-hover:text-foreground",children:[(0,s.jsx)("span",{className:"group-hover:hidden text-sm font-medium",children:r+1}),(0,s.jsx)(n.A,{className:"w-4 h-4 hidden group-hover:block"})]}),(0,s.jsx)("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center mr-2 md:mr-4 flex-shrink-0 overflow-hidden",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover"}):(0,s.jsx)(d.A,{className:"w-5 h-5 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0 mr-2 md:mr-6",children:[(0,s.jsxs)("div",{className:"flex items-start space-x-2 mb-1",children:[(0,s.jsx)("h3",{className:"text-foreground text-sm font-medium leading-tight break-words",children:e.title}),(0,s.jsx)(v,{source:e.source,size:16,className:"text-muted-foreground flex-shrink-0 mt-0.5"})]}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs leading-tight break-words",children:e.artist})]}),(0,s.jsx)("div",{className:"text-muted-foreground text-sm mr-2 md:mr-4 font-mono",children:e.duration||"0:00"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"hidden md:block",children:(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),P&&eR(P.id,e.id)},className:"p-2 hover:bg-red-500/20 rounded transition-all",title:"Удалить из плейлиста",children:(0,s.jsx)(g.A,{className:"w-4 h-4 text-muted-foreground hover:text-red-500"})})}),(0,s.jsx)("div",{className:"md:hidden",children:(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),P&&eR(P.id,e.id)},className:"p-2 hover:bg-red-500/20 rounded transition-all",title:"Удалить из плейлиста",children:(0,s.jsx)(g.A,{className:"w-4 h-4 text-muted-foreground hover:text-red-500"})})})]})]},e.id))})})]})]})]})}return(0,s.jsxs)("div",{className:"flex flex-col h-full bg-background text-foreground",children:[(0,s.jsxs)("div",{className:"p-4 md:p-6 space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,s.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),(0,s.jsx)(eN,{placeholder:"Поиск в библиотеке...",value:y,onChange:e=>N(e.target.value),className:"pl-10 bg-input border-border text-foreground placeholder-muted-foreground"})]})}),(0,s.jsxs)("div",{className:"flex justify-center space-x-3",children:[(0,s.jsxs)(V,{variant:"ghost",size:"sm",onClick:()=>eg(!0),className:"text-muted-foreground hover:text-foreground hover:bg-accent rounded-full",children:[(0,s.jsx)(tv.A,{className:"w-4 h-4 mr-2"}),"Импорт"]}),(0,s.jsxs)(en,{open:M,onOpenChange:E,children:[(0,s.jsx)(ei,{asChild:!0,children:(0,s.jsxs)(V,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground hover:bg-accent rounded-full",children:[(0,s.jsx)(D.A,{className:"w-4 h-4 mr-2"}),"Создать"]})}),(0,s.jsxs)(ed,{className:"bg-gradient-to-br from-background via-background/95 to-background/90 backdrop-blur-xl border border-border/50 max-w-md shadow-2xl",children:[(0,s.jsx)(em,{className:"text-center",children:(0,s.jsxs)(ex,{className:"text-foreground flex items-center justify-center space-x-2 text-xl font-bold",children:[(0,s.jsx)(D.A,{className:"w-6 h-6 text-primary"}),(0,s.jsx)("span",{children:"Создать плейлист"})]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(eN,{placeholder:"Название плейлиста",value:T,onChange:e=>O(e.target.value),className:"bg-input border-border text-foreground",onKeyDown:e=>{"Enter"===e.key&&eG()}})}),(0,s.jsx)("div",{className:"flex space-x-2",children:eW.slice(0,6).map(e=>{let t=e.icon;return(0,s.jsx)("button",{onClick:()=>W(e.id),className:(0,A.cn)("w-10 h-10 rounded-xl border-2 flex items-center justify-center transition-all duration-300 hover:scale-110",H===e.id?"border-primary bg-primary/20 text-primary shadow-lg shadow-primary/25":"border-border/50 bg-muted/50 hover:border-primary/30 hover:bg-primary/5 text-muted-foreground hover:text-primary"),title:e.label,children:(0,s.jsx)(t,{className:"w-5 h-5"})},e.id)})})]}),(0,s.jsxs)(V,{variant:"outline",onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if(r.size>5242880){alert("Размер файла должен быть меньше 5MB");return}if(!r.type.startsWith("image/")){alert("Пожалуйста, выберите изображение");return}ea(r)}},e.click()},className:"w-full rounded-xl border-2 hover:border-primary/30 hover:bg-primary/5 transition-all duration-300",children:[(0,s.jsx)(ez.A,{className:"w-4 h-4 mr-2"}),es?"Изменить обложку":"Выбрать обложку"]})]}),(0,s.jsxs)(eu,{className:"flex justify-center space-x-3",children:[(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:()=>{E(!1),O(""),W("music"),ea(null)},className:"w-10 h-10 rounded-full text-muted-foreground hover:text-foreground hover:bg-accent",title:"Отмена",children:(0,s.jsx)(p.A,{className:"w-4 h-4"})}),(0,s.jsx)(V,{size:"icon",onClick:eG,disabled:!T.trim(),className:"w-10 h-10 rounded-full bg-primary hover:bg-primary/90 text-primary-foreground",title:"Создать",children:(0,s.jsx)(D.A,{className:"w-4 h-4"})})]})]})]})]})]}),(0,s.jsx)("div",{className:"flex-1 px-4 md:px-6 pb-20",children:(0,s.jsx)(I,{className:"h-full",children:0===eY.length&&0===eX.length?(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(L,{variant:"playlist",title:"Библиотека пуста",subtitle:"Создайте свой первый плейлист или добавьте треки в избранное",className:"md:scale-110"}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsxs)(V,{variant:"ghost",onClick:()=>eg(!0),className:"bg-muted hover:bg-accent text-foreground",children:[(0,s.jsx)(tv.A,{className:"w-4 h-4 mr-2"}),"Импортировать плейлист"]})})]})}):(0,s.jsx)("div",{className:"grid gap-4 grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-8",children:eY.map((e,t)=>(0,s.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"group cursor-pointer",onClick:()=>e$(e),onContextMenu:t=>e0(t,e),children:[(0,s.jsxs)("div",{className:"relative mb-3",children:[(0,s.jsxs)("div",{className:"w-full aspect-square bg-gradient-to-br from-muted to-muted/50 rounded-2xl flex items-center justify-center overflow-hidden shadow-lg group-hover:shadow-xl transition-all duration-300 group-hover:scale-105",children:["favorites"===e.id?(0,s.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-red-500/20 to-red-600/30 flex items-center justify-center",children:(0,s.jsx)(o.A,{className:"w-12 h-12 text-red-500 fill-red-500"})}):e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-primary/10 to-primary/20 flex items-center justify-center",children:(()=>{let t=eW.find(t=>t.id===(e.icon||"music")),r=(null==t?void 0:t.icon)||d.A;return(0,s.jsx)(r,{className:"w-12 h-12 text-primary"})})()}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-all duration-300 flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:(0,s.jsx)(n.A,{className:"w-8 h-8 text-white"})})})]}),(0,s.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-all duration-300",children:(0,s.jsxs)(Q,{children:[(0,s.jsx)(J,{asChild:!0,children:(0,s.jsx)(V,{variant:"ghost",size:"sm",onClick:e=>e.stopPropagation(),className:"w-8 h-8 bg-black/50 hover:bg-black/70 text-white rounded-full p-0",children:(0,s.jsx)(F.A,{className:"w-4 h-4"})})}),(0,s.jsxs)(K,{children:["favorites"!==e.id&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(q,{onClick:()=>e2(e),children:[(0,s.jsx)(tj.A,{className:"w-4 h-4 mr-2"}),"Переименовать"]}),(0,s.jsxs)(q,{onClick:t=>{if(t.stopPropagation(),e.coverArt)confirm("Удалить обложку плейлиста?")&&e8(e);else{let t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=t=>{var r;let s=null===(r=t.target.files)||void 0===r?void 0:r[0];if(s){if(s.size>5242880){alert("Размер файла должен быть меньше 5MB");return}if(!s.type.startsWith("image/")){alert("Пожалуйста, выберите изображение");return}e5(e,s)}},t.click()}},disabled:et,className:e.coverArt?"text-destructive focus:text-destructive/80":"",children:[et?(0,s.jsx)(l.A,{className:"w-4 h-4 mr-2 animate-spin"}):e.coverArt?(0,s.jsx)(g.A,{className:"w-4 h-4 mr-2"}):(0,s.jsx)(ez.A,{className:"w-4 h-4 mr-2"}),et?"Загрузка...":e.coverArt?"Удалить обложку":e.coverArt?"Удалить обложку":"Загрузить обложку"]}),(0,s.jsxs)(q,{onClick:()=>e3(e.id),className:"text-red-400 focus:text-red-300",children:[(0,s.jsx)(g.A,{className:"w-4 h-4 mr-2"}),"Удалить"]})]}),"favorites"===e.id&&(0,s.jsxs)(q,{disabled:!0,className:"text-muted-foreground",children:[(0,s.jsx)(o.A,{className:"w-4 h-4 mr-2"}),"Системный плейлист"]})]})]})})]}),(0,s.jsxs)("div",{className:"px-1",children:[(0,s.jsx)("h3",{className:"font-semibold truncate text-sm text-foreground group-hover:text-primary transition-colors duration-200",children:e.title}),(0,s.jsxs)("p",{className:"text-muted-foreground text-xs mt-1",children:["favorites"===e.id?ej.length:e.trackCount||0," треков"]})]})]},"".concat(e.id,"-").concat(t)))})})}),R&&(0,s.jsx)(en,{open:!!R,onOpenChange:()=>U(null),children:(0,s.jsxs)(ed,{className:"bg-card border-border max-w-sm",children:[(0,s.jsx)(em,{className:"text-center",children:(0,s.jsxs)(ex,{className:"text-foreground flex items-center justify-center space-x-2",children:[(0,s.jsx)(tj.A,{className:"w-5 h-5 text-primary"}),(0,s.jsx)("span",{children:"Редактировать плейлист"})]})}),(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(eN,{value:_,onChange:e=>B(e.target.value),className:"bg-input border-border text-foreground",placeholder:"Название плейлиста",onKeyDown:e=>{"Enter"===e.key&&e4()}})}),(0,s.jsx)("div",{className:"flex space-x-2",children:eW.slice(0,6).map(e=>{let t=e.icon;return(0,s.jsx)("button",{onClick:()=>W(e.id),className:(0,A.cn)("w-10 h-10 rounded-xl border-2 flex items-center justify-center transition-all duration-300 hover:scale-110",H===e.id?"border-primary bg-primary/20 text-primary shadow-lg shadow-primary/25":"border-border/50 bg-muted/50 hover:border-primary/30 hover:bg-primary/5 text-muted-foreground hover:text-primary"),title:e.label,children:(0,s.jsx)(t,{className:"w-5 h-5"})},e.id)})})]})}),(0,s.jsxs)(eu,{className:"flex justify-center space-x-3",children:[(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:()=>{U(null),B(""),W("music")},className:"w-10 h-10 rounded-full text-muted-foreground hover:text-foreground hover:bg-accent",title:"Отмена",children:(0,s.jsx)(p.A,{className:"w-4 h-4"})}),(0,s.jsx)(V,{size:"icon",onClick:e4,disabled:!_.trim(),className:"w-10 h-10 rounded-full bg-primary hover:bg-primary/90 text-primary-foreground",title:"Сохранить",children:(0,s.jsx)(eL.A,{className:"w-4 h-4"})})]})]})}),(0,s.jsx)(en,{open:ep,onOpenChange:eg,children:(0,s.jsxs)(ed,{className:"bg-card border-border max-w-sm",children:[(0,s.jsx)(em,{className:"text-center",children:(0,s.jsxs)(ex,{className:"text-foreground flex items-center justify-center space-x-2",children:[(0,s.jsx)(tv.A,{className:"w-5 h-5 text-primary"}),(0,s.jsx)("span",{children:"Импорт плейлиста"})]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(eN,{placeholder:"URL плейлиста SoundCloud",value:X,onChange:e=>Y(e.target.value),className:"bg-input border-border text-foreground"}),Z&&(0,s.jsx)("p",{className:"text-destructive text-sm",children:Z})]}),(0,s.jsxs)(eu,{className:"flex justify-center space-x-3",children:[(0,s.jsx)(V,{variant:"ghost",size:"icon",onClick:()=>{eg(!1),Y(""),G("")},className:"w-10 h-10 rounded-full text-muted-foreground hover:text-foreground hover:bg-accent",title:"Отмена",children:(0,s.jsx)(p.A,{className:"w-4 h-4"})}),(0,s.jsx)(V,{size:"icon",onClick:()=>eH(X),disabled:!X.trim()||$,className:"w-10 h-10 rounded-full bg-primary hover:bg-primary/90 text-primary-foreground",title:"Импортировать",children:$?(0,s.jsx)(l.A,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(tv.A,{className:"w-4 h-4"})})]})]})}),eb.isOpen&&eb.playlist&&(0,s.jsx)(ey,{isOpen:eb.isOpen,onClose:e1,x:eb.x,y:eb.y,playlist:eb.playlist,onPlay:()=>{e7(eb.playlist),e1()},onExport:()=>{eB(eb.playlist),e1()},onEdit:()=>{ef(eb.playlist),eo(!0),e1()},onDelete:()=>{var e;(null===(e=eb.playlist)||void 0===e?void 0:e.id)!=="favorites"&&e3(eb.playlist.id),e1()}}),ec&&(0,s.jsx)(eM,{isOpen:el,onClose:()=>{eo(!1),ef(null)},playlist:ec,onRename:eD,onCoverChange:eU,onCoverRemove:eF}),(0,s.jsx)(tw,{isOpen:ep,onClose:()=>eg(!1),onImport:async e=>{if("string"==typeof e)await eH(e);else{let t=new File([JSON.stringify(e)],"playlist.json",{type:"application/json"});await eV(t)}}})]})}function tC(){let[e,t]=(0,a.useState)(null),[r,l]=(0,a.useState)(!1),[n,i]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if("serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(e=>{console.log("SW registered: ",e)}).catch(e=>{console.log("SW registration failed: ",e)}),window.matchMedia("(display-mode: standalone)").matches){i(!0);return}let e=e=>{e.preventDefault(),t(e),l(!0)},r=()=>{i(!0),l(!1),t(null)};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",r),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",r)}},[]);let o=async()=>{if(e)try{await e.prompt();let{outcome:r}=await e.userChoice;"accepted"===r?console.log("PWA установлено пользователем"):console.log("PWA отклонено пользователем"),t(null),l(!1)}catch(e){console.error("Ошибка при установке PWA:",e)}};return!n&&r&&e?(0,s.jsx)(u.N,{children:(0,s.jsx)(m.P.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},className:"fixed bottom-4 left-4 right-4 z-50 md:left-auto md:right-4 md:max-w-sm",children:(0,s.jsx)("div",{className:"bg-background/95 backdrop-blur-xl border border-border rounded-xl p-4 shadow-2xl",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("div",{className:"w-10 h-10 bg-primary/20 rounded-lg flex items-center justify-center",children:(0,s.jsx)(_.A,{className:"w-5 h-5 text-primary"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-foreground mb-1",children:"Установить Dotify"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-3",children:"Установите приложение для быстрого доступа и лучшего опыта"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(V,{onClick:o,size:"sm",className:"flex-1",children:[(0,s.jsx)(_.A,{className:"w-4 h-4 mr-2"}),"Установить"]}),(0,s.jsx)(V,{onClick:()=>{l(!1),t(null)},variant:"ghost",size:"sm",className:"px-2",children:(0,s.jsx)(p.A,{className:"w-4 h-4"})})]})]})]})})})}):null}let tS=()=>{let{autoPlay:e,getServiceToken:t}=(0,eW.t)(),[r,s]=(0,a.useState)(()=>{{let e=localStorage.getItem("playerState");if(e)try{let t=JSON.parse(e);return{currentTrack:null,isPlaying:!1,isLoading:!1,currentTime:0,duration:0,volume:t.volume||.5,repeatMode:t.repeatMode||"none",shuffle:t.shuffle||!1}}catch(e){console.error("Failed to parse saved player state:",e)}}return{currentTrack:null,isPlaying:!1,isLoading:!1,currentTime:0,duration:0,volume:.5,repeatMode:"none",shuffle:!1}}),[l,n]=(0,a.useState)({tracks:[],currentIndex:-1,history:[],shuffledIndices:[],currentShuffleIndex:-1}),i=(0,a.useRef)(null),o=(0,a.useRef)({active:!1,trackId:null,abortController:null});(0,a.useEffect)(()=>{{i.current=new Audio,i.current.preload="none",i.current.volume=r.volume;let e=()=>{i.current&&s(e=>{var t,r;return{...e,currentTime:(null===(t=i.current)||void 0===t?void 0:t.currentTime)||0,duration:(null===(r=i.current)||void 0===r?void 0:r.duration)||0}})},t=()=>{s(e=>({...e,isLoading:!0}))},a=()=>{s(e=>({...e,isLoading:!1}))},l=async e=>{console.error("[usePlayer] Audio error:",e);let t=e.target;if(t.error&&(console.error("[usePlayer] Audio error details:",{code:t.error.code,message:t.error.message}),4===t.error.code||2===t.error.code)){console.log("[usePlayer] Attempting to get fresh URL due to audio error...");let e=r.currentTrack;if(e)try{let t=await tk.Q.getStreamUrl(e.id,e.source||"soundcloud");if(t){let e="string"==typeof t?t:t.url;e&&i.current&&(i.current.src=e,console.log("[usePlayer] Updated audio source with fresh URL"))}}catch(e){console.error("[usePlayer] Failed to get fresh URL:",e)}}};return i.current.addEventListener("timeupdate",e),i.current.addEventListener("loadstart",t),i.current.addEventListener("canplay",a),i.current.addEventListener("error",l),()=>{i.current&&(i.current.removeEventListener("timeupdate",e),i.current.removeEventListener("loadstart",t),i.current.removeEventListener("canplay",a),i.current.removeEventListener("error",l))}}},[]),(0,a.useEffect)(()=>{i.current&&(i.current.volume=r.volume)},[r.volume]);let c=e=>{if("number"==typeof e)return e;let t=e.split(":");return 2===t.length?60*parseInt(t[0],10)+parseInt(t[1],10):0},d=(0,a.useCallback)(async function(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=arguments.length>2?arguments[2]:void 0;if(console.log("[usePlayer] Playing track:",e.title),!e){console.warn("[usePlayer] No track provided");return}if(o.current.active&&o.current.trackId===e.id){console.log("[usePlayer] Already loading this track");return}o.current.active&&o.current.abortController&&o.current.abortController.abort();let l=new AbortController;o.current={active:!0,trackId:e.id,abortController:l},s(e=>({...e,isPlaying:r}));try{let n=null,o=!1;if(e.directUrl&&e.directUrl.length>10){if(e.directUrl.includes("cf-media.sndcdn.com"))try{let t=new URL(e.directUrl).searchParams.get("Expires");t&&Date.now()<1e3*parseInt(t)?(o=!0,n=e.directUrl,console.log("[usePlayer] Using existing directUrl (not expired)")):console.log("[usePlayer] Existing directUrl expired, getting fresh URL")}catch(e){console.log("[usePlayer] Error checking URL expiration, getting fresh URL")}else o=!0,n=e.directUrl,console.log("[usePlayer] Using existing directUrl (non-SoundCloud)")}if(!o){s(e=>({...e,isLoading:!0})),console.log("[usePlayer] Getting stream URL from API");let r=e.source||"soundcloud",a=t(r),l=await tk.Q.getStreamUrl(e.id,r,a);"string"==typeof l?n=l:l&&"object"==typeof l&&"url"in l&&(n=l.url)}if(!n)throw Error("Failed to get stream URL");if(l.signal.aborted)return;let d=c(e.duration),m={...e,url:n};if(s(e=>({...e,currentTrack:m,duration:d})),localStorage.setItem("lastTrack",JSON.stringify(m)),i.current&&(i.current.src=n,a&&(i.current.currentTime=a),r))try{await i.current.play(),s(e=>({...e,isPlaying:!0}))}catch(r){if(console.error("[usePlayer] Play failed:",r),r instanceof Error&&r.message.includes("Failed to load")){console.log("[usePlayer] Retrying with fresh URL...");let r=e.source||"soundcloud",a=t(r),l=await tk.Q.getStreamUrl(e.id,r,a);if(l){let e="string"==typeof l?l:l.url;if(e&&i.current){i.current.src=e;try{await i.current.play(),s(e=>({...e,isPlaying:!0})),console.log("[usePlayer] Retry successful with fresh URL")}catch(e){console.error("[usePlayer] Retry failed:",e)}}}}}console.log("[usePlayer] Track loaded successfully")}catch(t){console.error("[usePlayer] Error playing track:",t),!(t instanceof DOMException&&"AbortError"===t.name)&&(console.error("Failed to play track:",e.title),t instanceof Error&&t.message.includes("Failed to get stream URL")&&console.log("[usePlayer] Track not playable:",e.title))}finally{o.current.active=!1,o.current.abortController=null,s(e=>({...e,isLoading:!1}))}},[e,t]);(0,a.useEffect)(()=>{{let e={volume:r.volume,repeatMode:r.repeatMode,shuffle:r.shuffle};localStorage.setItem("playerState",JSON.stringify(e))}},[r.volume,r.repeatMode,r.shuffle]),(0,a.useEffect)(()=>{if(e){let e=localStorage.getItem("lastTrack");if(e)try{let t=JSON.parse(e);r.currentTrack&&r.currentTrack.id===t.id||(console.log("[usePlayer] Auto-playing last track:",t.title),d(t,!0))}catch(e){console.error("[usePlayer] Failed to parse last track:",e)}}},[e,d,r.currentTrack]);let m=(0,a.useCallback)(async()=>{if(i.current&&r.currentTrack){if(r.isPlaying)i.current.pause(),s(e=>({...e,isPlaying:!1}));else try{await i.current.play(),s(e=>({...e,isPlaying:!0}))}catch(e){console.error("[usePlayer] Play failed:",e)}}},[r.isPlaying,r.currentTrack]),u=(0,a.useCallback)(async()=>{if(0===l.tracks.length)return;r.currentTrack&&n(e=>({...e,history:[...e.history,r.currentTrack]}));let e=null;if(r.shuffle&&l.shuffledIndices.length>0){let t=l.currentShuffleIndex+1;if(t<l.shuffledIndices.length){let r=l.shuffledIndices[t];e=l.tracks[r]||null,n(e=>({...e,currentShuffleIndex:t,currentIndex:r}))}else if("repeat"===r.repeatMode){let t=l.shuffledIndices[0];e=l.tracks[t]||null,n(e=>({...e,currentShuffleIndex:0,currentIndex:t}))}}else{let t=l.currentIndex+1;t<l.tracks.length?(e=l.tracks[t],n(e=>({...e,currentIndex:t}))):"repeat"===r.repeatMode&&(e=l.tracks[0]||null,n(e=>({...e,currentIndex:0})))}e&&await d(e,!0)},[l,r.currentTrack,r.repeatMode,r.shuffle,d]);(0,a.useEffect)(()=>{if(i.current){let e=()=>{"repeat"===r.repeatMode?i.current&&(i.current.currentTime=0,i.current.play()):u()};return i.current.addEventListener("ended",e),()=>{i.current&&i.current.removeEventListener("ended",e)}}},[r.repeatMode,u]);let x=(0,a.useCallback)(async()=>{if(0===l.tracks.length)return;let e=null;if(r.shuffle&&l.shuffledIndices.length>0){let t=l.currentShuffleIndex-1;if(t>=0){let r=l.shuffledIndices[t];e=l.tracks[r]||null,n(e=>({...e,currentShuffleIndex:t,currentIndex:r}))}else if(l.history.length>0){let e=l.history[l.history.length-1];n(e=>({...e,history:e.history.slice(0,-1)})),await d(e,!0);return}}else{let t=l.currentIndex-1;if(t>=0)e=l.tracks[t],n(e=>({...e,currentIndex:t}));else if(l.history.length>0){let e=l.history[l.history.length-1];n(e=>({...e,history:e.history.slice(0,-1)})),await d(e,!0);return}}e&&await d(e,!0)},[l,r.shuffle,d]),h=(0,a.useCallback)(e=>{n(t=>{let s=[...t.tracks,...e],a=0===t.tracks.length?0:t.currentIndex;if(r.shuffle){let e=Array.from({length:s.length},(e,t)=>t);for(let t=e.length-1;t>0;t--){let r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return{...t,tracks:s,shuffledIndices:e,currentIndex:a,currentShuffleIndex:t.currentShuffleIndex}}return{...t,tracks:s,currentIndex:a}})},[r.shuffle]),f=(0,a.useCallback)(()=>{n(e=>{if(0===e.tracks.length)return e;let t=e.tracks.map((e,t)=>t);for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return{...e,shuffledIndices:t,currentShuffleIndex:0}})},[]),p=(0,a.useCallback)(()=>{n(e=>({...e,shuffledIndices:[],currentShuffleIndex:-1}))},[]),g=(0,a.useCallback)(()=>{n({tracks:[],currentIndex:-1,history:[],shuffledIndices:[],currentShuffleIndex:-1}),s(e=>({...e,currentTrack:null}))},[]),b=(0,a.useCallback)(e=>{i.current&&(i.current.currentTime=e)},[]),v=(0,a.useCallback)(e=>{s(t=>({...t,volume:e}))},[]),j=(0,a.useCallback)(()=>{s(e=>({...e,repeatMode:"none"===e.repeatMode?"repeat":"none"}))},[]),y=(0,a.useCallback)(()=>{s(e=>{let t=!e.shuffle;return t?f():p(),{...e,shuffle:t}})},[f,p]),N=(0,a.useCallback)(()=>{if(0===l.tracks.length)return null;if(r.shuffle&&l.shuffledIndices.length>0){let e=l.currentShuffleIndex+1;if(e<l.shuffledIndices.length){let t=l.shuffledIndices[e];return l.tracks[t]||null}if("repeat"===r.repeatMode){let e=l.shuffledIndices[0];return l.tracks[e]||null}}else{let e=l.currentIndex+1;if(e<l.tracks.length)return l.tracks[e];if("repeat"===r.repeatMode)return l.tracks[0]||null}return null},[l,r.shuffle,r.repeatMode]);return{currentTrack:r.currentTrack,isPlaying:r.isPlaying,isLoading:r.isLoading,currentTime:r.currentTime,duration:r.duration,volume:r.volume,repeatMode:r.repeatMode,shuffle:r.shuffle,queue:l.tracks,currentIndex:l.currentIndex,playTrack:d,handlePlayPause:m,handleNext:u,handlePrevious:x,addToQueue:h,clearQueue:g,seekTo:b,setVolume:v,toggleRepeat:j,toggleShuffle:y,shuffleQueue:f,unshuffleQueue:p,getNextTrack:N}};function tP(){let{hapticFeedback:e,showBackButton:t,hideBackButton:r}=function(){var e;let[t,r]=(0,a.useState)(null),[s,l]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=()=>{var e;if(null===(e=window.Telegram)||void 0===e?void 0:e.WebApp){let e=window.Telegram.WebApp;r(e),e.ready(),e.expand(),e.themeParams&&(document.documentElement.style.setProperty("--tg-theme-bg-color",e.themeParams.bg_color||"#000000"),document.documentElement.style.setProperty("--tg-theme-text-color",e.themeParams.text_color||"#ffffff"),document.documentElement.style.setProperty("--tg-theme-hint-color",e.themeParams.hint_color||"#999999"),document.documentElement.style.setProperty("--tg-theme-link-color",e.themeParams.link_color||"#2481cc"),document.documentElement.style.setProperty("--tg-theme-button-color",e.themeParams.button_color||"#2481cc"),document.documentElement.style.setProperty("--tg-theme-button-text-color",e.themeParams.button_text_color||"#ffffff")),l(!0)}};e();let t=setInterval(()=>{var r;(null===(r=window.Telegram)||void 0===r?void 0:r.WebApp)&&(e(),clearInterval(t))},100);return setTimeout(()=>clearInterval(t),5e3),()=>clearInterval(t)},[]),{webApp:t,isReady:s,user:null==t?void 0:null===(e=t.initDataUnsafe)||void 0===e?void 0:e.user,platform:null==t?void 0:t.platform,colorScheme:null==t?void 0:t.colorScheme,viewportHeight:null==t?void 0:t.viewportHeight,viewportStableHeight:null==t?void 0:t.viewportStableHeight,hapticFeedback:{impact:function(){var e;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"medium";null==t||null===(e=t.HapticFeedback)||void 0===e||e.impactOccurred(r)},notification:e=>{var r;null==t||null===(r=t.HapticFeedback)||void 0===r||r.notificationOccurred(e)},selection:()=>{var e;null==t||null===(e=t.HapticFeedback)||void 0===e||e.selectionChanged()}},showMainButton:(e,r)=>{(null==t?void 0:t.MainButton)&&(t.MainButton.setText(e),t.MainButton.onClick(r),t.MainButton.show())},hideMainButton:()=>{var e;null==t||null===(e=t.MainButton)||void 0===e||e.hide()},showBackButton:e=>{(null==t?void 0:t.BackButton)&&(t.BackButton.onClick(e),t.BackButton.show())},hideBackButton:()=>{var e;null==t||null===(e=t.BackButton)||void 0===e||e.hide()},close:()=>null==t?void 0:t.close()}}(),[x,f]=(0,a.useState)("home"),[p,g]=(0,a.useState)(null),[b,v]=(0,a.useState)("home"),[j,y]=(0,a.useState)(""),[N,w]=(0,a.useState)(null),[k,A]=(0,a.useState)({tracks:[],playlists:[]}),[C,S]=(0,a.useState)(!1),[P,z]=(0,a.useState)("tracks"),[L,M]=(0,a.useState)("soundcloud"),[T,O]=(0,a.useState)(!1),[R,D]=(0,a.useState)(!1),[U,_]=(0,a.useState)(!1),[F,B]=(0,a.useState)(!1),[H,W]=(0,a.useState)("recent"),[Q,J]=(0,a.useState)(!1),[K,q]=(0,a.useState)(!1),[X,Y]=(0,a.useState)(!1),[G,$]=(0,a.useState)(null),[ee,et]=(0,a.useState)(!0),[el,en]=(0,a.useState)(!1),{currentTrack:ei,isPlaying:eo,isLoading:ec,currentTime:ed,duration:em,volume:eu,repeatMode:ex,shuffle:ep,queue:eg,playTrack:eb,handlePlayPause:ev,handleNext:ej,handlePrevious:ey,addToQueue:eN,clearQueue:ew,seekTo:ek,setVolume:eA,toggleRepeat:eC,toggleShuffle:eS,getNextTrack:eP}=tS();!function(e){let{currentTrack:t,isPlaying:r,onPlay:s,onPause:l,onPrevious:n,onNext:i,onSeek:o,position:c,duration:d}=e;(0,a.useEffect)(()=>{if(!("mediaSession"in navigator))return;let e=navigator.mediaSession;t?e.metadata=new MediaMetadata({title:t.title,artist:t.artist,album:t.album||"Unknown Album",artwork:t.coverArt?[{src:t.coverArt,sizes:"512x512",type:"image/jpeg"},{src:t.coverArt,sizes:"256x256",type:"image/jpeg"},{src:t.coverArt,sizes:"128x128",type:"image/jpeg"}]:[{src:"/icon-512.png",sizes:"512x512",type:"image/png"}]}):e.metadata=null,e.playbackState=r?"playing":"paused"},[t,r]),(0,a.useEffect)(()=>{if(!("mediaSession"in navigator)||!t)return;let e=navigator.mediaSession;if(d>0)try{e.setPositionState({duration:d,playbackRate:1,position:c})}catch(e){}},[t,c,d]),(0,a.useEffect)(()=>{if(!("mediaSession"in navigator))return;let e=navigator.mediaSession;try{e.setActionHandler("play",()=>{s()}),e.setActionHandler("pause",()=>{l()}),e.setActionHandler("previoustrack",()=>{n()}),e.setActionHandler("nexttrack",()=>{i()}),e.setActionHandler("seekto",e=>{void 0!==e.seekTime&&o(e.seekTime)}),e.setActionHandler("seekbackward",e=>{o(Math.max(0,c-(e.seekOffset||10)))}),e.setActionHandler("seekforward",e=>{o(Math.min(d,c+(e.seekOffset||10)))}),e.setActionHandler("stop",()=>{l()})}catch(e){}return()=>{try{e.setActionHandler("play",null),e.setActionHandler("pause",null),e.setActionHandler("previoustrack",null),e.setActionHandler("nexttrack",null),e.setActionHandler("seekto",null),e.setActionHandler("seekbackward",null),e.setActionHandler("seekforward",null),e.setActionHandler("stop",null)}catch(e){}}},[s,l,n,i,o,c,d])}({currentTrack:ei,isPlaying:eo,onPlay:()=>ev(),onPause:()=>ev(),onPrevious:ey,onNext:ej,onSeek:ek,position:ed,duration:em});let{theme:ez,setTrackTheme:eL,customBackground:eM,backgroundBlur:eE,backgroundDarkness:eT}=(0,e6.DP)(),eO=(0,eJ.l)(),[eR,eD]=(0,a.useState)(!1);(0,a.useEffect)(()=>{en(!0);let e=localStorage.getItem("sidebarCollapsed");e&&_(JSON.parse(e))},[]),(0,a.useEffect)(()=>{localStorage.setItem("sidebarCollapsed",JSON.stringify(U))},[U]),(0,a.useEffect)(()=>{"track"===ez&&(null==ei?void 0:ei.coverArt)&&eL(ei.coverArt)},[ez,null==ei?void 0:ei.coverArt,eL]);let{favorites:eU,playlists:e_,recentTracks:eF,toggleFavorite:eH,addToFavorites:eV,addPlaylist:eq,removePlaylist:eX,updatePlaylist:eY,addRecentTrack:eZ,addTrackToPlaylist:eG}=(0,eh.t)(),{getServiceToken:e$}=(0,eW.t)(),e0=async e=>{if(eg.find(t=>t.id===e.id)||eN([e]),await eb(e,!0),"search"===x&&k.tracks.length>0){let t=k.tracks.findIndex(t=>t.id===e.id);-1!==t&&t<k.tracks.length-1&&k.tracks.slice(t+1).forEach(e=>{eg.find(t=>t.id===e.id)||eN([e])})}if("playlist"===x&&(null==N?void 0:N.tracks)&&N.tracks.length>0){let t=N.tracks.findIndex(t=>t.id===e.id);-1!==t&&t<N.tracks.length-1&&N.tracks.slice(t+1).forEach(e=>{eg.find(t=>t.id===e.id)||eN([e])})}},e1=async e=>{if(g(x),e.id.startsWith("playlist_")){w(e),f("playlist"),e.tracks&&e.tracks.length>0&&(ew(),eN(e.tracks),await eb(e.tracks[0],!0));return}if(!e.tracks||0===e.tracks.length){O(!0);try{let t=e.source||"soundcloud",r=e$(t),s=await tk.Q.importPlaylist(e.id,t,r);if((null==s?void 0:s.success)&&s.playlist){w(s.playlist),f("playlist"),s.playlist.tracks&&s.playlist.tracks.length>0&&(ew(),eN(s.playlist.tracks),await eb(s.playlist.tracks[0],!0));return}console.error("Import failed:",null==s?void 0:s.error)}finally{O(!1)}}w(e),f("playlist"),e.tracks&&e.tracks.length>0&&(ew(),eN(e.tracks),await eb(e.tracks[0],!0))},e2=e=>{switch(v(e),"player"!==x&&g(x),e){case"home":f("home");break;case"search":f("search");break;case"library":f("library")}},e4=async e=>{if(eZ(e),N&&N.tracks){let t=N.tracks.findIndex(t=>t.id===e.id);if(-1!==t){let r=N.tracks.slice(t);ew(),eN(r),await eb(e,!0);return}}else eg.find(t=>t.id===e.id)||eN([e]);await eb(e,!0)},e3=async()=>{B(!0),J(!0);try{let e=[];if("recent"===H){if(0===eF.length){eO.error("Сначала послушайте несколько треков для создания волны!");return}e=[...eF].sort(()=>Math.random()-.5).slice(0,5).map(e=>({source:"soundcloud",title:e.title,artist:e.artist}))}else if("playlists"===H){if(0===e_.length){eO.error("Создайте плейлисты для генерации волны!");return}let t=[...e_].sort(()=>Math.random()-.5).slice(0,3).flatMap(e=>e.tracks&&e.tracks.length>0?[...e.tracks].sort(()=>Math.random()-.5).slice(0,2):[]);if(0===t.length){eO.error("Добавьте треки в ваши плейлисты для создания волны!");return}e=t.map(e=>({source:"soundcloud",title:e.title,artist:e.artist}))}else if("favorites"===H){if(0===eU.length){eO.error("Добавьте треки в избранное для создания волны!");return}e=[...eU].sort(()=>Math.random()-.5).slice(0,10).map(e=>({source:"soundcloud",title:e.title,artist:e.artist}))}if(e=e.filter(e=>e.artist&&!["unknown artist","неизвестный исполнитель","unknown",""].includes(e.artist.trim().toLowerCase())),0===e.length){eO.error("Недостаточно данных для создания волны");return}let t=[],r="soundcloud",s=e$("soundcloud");if(!s){eO.error("Необходим SoundCloud токен для создания волны. Добавьте его в настройках.");return}try{t=await tk.Q.generateWave("soundcloud",e,s),r="soundcloud"}catch(e){t=[]}let a=t.filter(e=>e.artist&&!["unknown artist","неизвестный исполнитель","unknown",""].includes(e.artist.trim().toLowerCase()));if(0===a.length){let r=e.slice(0,3),a=[];for(let e of r)try{let t=await tk.Q.getSimilarTracks(e.artist,"soundcloud",s);a.push(...t.slice(0,5))}catch(e){}if(a.length>0){let e=new Map;a.forEach(t=>{let r=t.id||"".concat(t.title,"-").concat(t.artist);e.has(r)||e.set(r,{id:r,title:t.title||"Неизвестный трек",artist:t.artist||"Неизвестный исполнитель",coverArt:t.coverArt||t.artwork_url||"",duration:t.duration||0,durationString:t.durationString||"0:00",source:"soundcloud",originalId:t.id,liked:eU.some(e=>e.id===r),streamable:!0})}),t=Array.from(e.values())}else t=[..."favorites"===H?eU:e_.flatMap(e=>e.tracks||[]).slice(0,20)].sort(()=>Math.random()-.5).slice(0,15).map(e=>({id:e.id,title:e.title,artist:e.artist,coverArt:e.coverArt,duration:e.duration,durationString:e.durationString,source:"soundcloud",originalId:e.originalId,liked:e.liked,streamable:!0}))}let l=new Map;t.forEach(e=>{let t=e.id||"".concat(e.title,"-").concat(e.artist);if(!l.has(t)){let s={id:t,title:e.title||"Неизвестный трек",artist:e.artist||"Неизвестный исполнитель",coverArt:e.coverArt||e.artwork_url||"",duration:e.duration||0,durationString:e.durationString||"0:00",source:e.source||r,originalId:e.id,liked:eU.some(e=>e.id===t),streamable:!0};l.set(t,s)}});let n=Array.from(l.values());if(n.length>0){ew(),eN(n);try{await eb(n[0],!0);let e=a.length>0?"SoundCloud":"ваших данных";eO.success("Создана волна из ".concat(n.length," треков с ").concat(e," на основе ").concat("favorites"===H?"избранного":"плейлистов"))}catch(e){console.warn("Failed to play first track, but wave was created:",e),eO.success("Создана волна из ".concat(n.length," треков. Некоторые треки могут быть недоступны для воспроизведения."))}}else throw Error("Не удалось создать волну")}catch(e){console.error("Wave generation error:",e),eO.error("Ошибка при создании волны. Попробуйте еще раз.")}finally{B(!1),J(!1)}},e5=async e=>{if(!e.trim()){A({tracks:[],playlists:[]});return}S(!0);try{let t=e$(L),r=await tk.Q.search(e,20,L,t),s={tracks:r.tracks.map(e=>({...e,durationString:e.duration,source:e.source||L||"soundcloud",streamable:!1,coverArt:e.coverArt||null,originalId:e.id,liked:e.liked||!1})),playlists:r.playlists.map(e=>{var t;return{...e,tracks:(null===(t=e.tracks)||void 0===t?void 0:t.map(e=>({...e,durationString:e.duration,source:e.source||L||"soundcloud",streamable:!1,coverArt:e.coverArt||null,originalId:e.id,liked:e.liked||!1})))||(e.trackCount,[])}})};A(s)}catch(e){console.error("Search error:",e),A({tracks:[],playlists:[]})}finally{S(!1)}};(0,a.useEffect)(()=>{let e=setTimeout(()=>{et(!1)},1e3);return()=>clearTimeout(e)},[]),(0,a.useEffect)(()=>{"track"!==ez&&(document.documentElement.style.removeProperty("--background"),document.documentElement.style.removeProperty("--foreground"),document.documentElement.style.removeProperty("--primary"),document.documentElement.style.removeProperty("--accent"))},[]),(0,a.useEffect)(()=>{let e=setTimeout(()=>{j?e5(j):A({tracks:[],playlists:[]})},500);return()=>clearTimeout(e)},[j,L,P]);let e8=k.tracks.length>0||k.playlists.length>0;return ee||!el?(0,s.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",suppressHydrationWarning:!0,children:(0,s.jsx)(m.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.8,ease:"easeOut"},className:"text-center",children:(0,s.jsx)("div",{className:"w-32 h-32 flex items-center justify-center mx-auto",children:(0,s.jsx)(h,{size:64,className:"text-foreground"})})})}):(0,s.jsx)("div",{className:"min-h-screen bg-background text-foreground relative",children:(0,s.jsxs)("div",{className:"tg-safe-area min-h-screen relative z-10 bg-background",children:[eM&&(0,s.jsx)("div",{className:"absolute inset-0 z-0 pointer-events-none",style:{backgroundImage:"url(".concat(eM,")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",filter:"blur(".concat(eE,"px)"),opacity:Math.max(.1,1-eT/100)}}),el&&(0,s.jsx)(tc,{activeTab:b,onTabChange:e2,collapsed:U,onCollapsedChange:_,currentPlaylist:N,onPlaylistSelect:e=>{w(e),f("library")},onPlayPlaylist:e=>{e.tracks&&e.tracks.length>0&&(ew(),eN(e.tracks),eb(e.tracks[0]))}}),(0,s.jsx)("div",{className:"min-h-screen bg-background ".concat(ei&&"player"!==x?"pb-16 md:pb-0":""," ").concat(U?"md:ml-20":"md:ml-68"),children:(0,s.jsxs)("div",{className:"flex-1 flex flex-col h-screen overflow-y-auto",children:["home"===x&&(0,s.jsxs)("div",{className:"flex-1 p-4 md:p-6",children:[(0,s.jsx)("div",{className:"hidden md:block mb-8",children:(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"relative h-96 w-[40rem] flex flex-col items-center justify-center rounded-3xl overflow-hidden bg-background/5 backdrop-blur-sm border border-border/20",children:[(0,s.jsxs)("div",{className:"absolute inset-0 pointer-events-none z-0",children:[(0,s.jsx)("div",{className:"absolute -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2 w-80 h-80 bg-gradient-to-br from-primary via-primary/80 to-primary/40 rounded-full blur-3xl opacity-60 animate-pulse"}),(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 w-64 h-64 -translate-x-1/4 -translate-y-1/4 bg-gradient-to-br from-primary/60 to-primary/20 rounded-full blur-2xl opacity-50 animate-pulse",style:{animationDelay:"1s"}}),(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 w-48 h-48 translate-x-1/4 translate-y-1/4 bg-gradient-to-br from-primary/40 to-primary/10 rounded-full blur-xl opacity-40 animate-pulse",style:{animationDelay:"2s"}})]}),(0,s.jsxs)("div",{className:"text-center flex flex-col items-center justify-center w-full p-16 z-10",children:[(0,s.jsxs)("button",{onClick:e3,disabled:F,className:"group flex flex-col items-center gap-10 text-white transition-all duration-300 ease-in-out hover:scale-105 disabled:cursor-not-allowed",children:[F?(0,s.jsx)("div",{className:"h-32 w-32 rounded-full bg-white/20 flex items-center justify-center",children:(0,s.jsx)(l.A,{className:"animate-spin h-16 w-16 text-white"})}):(0,s.jsx)("div",{className:"h-32 w-32 rounded-full bg-white/20 border border-white/30 flex items-center justify-center transition-all duration-300 group-hover:bg-white/30",children:(0,s.jsx)(n.A,{className:"h-16 w-16 text-white ml-1"})}),(0,s.jsx)("span",{className:"text-6xl font-bold text-center w-full text-white",children:"Моя волна"})]}),(0,s.jsx)("div",{className:"mt-10 flex items-center gap-2",children:(0,s.jsx)(V,{variant:"ghost",size:"sm",onClick:()=>{let e=["recent","favorites","playlists"],t=(e.indexOf(H)+1)%e.length;W(e[t])},className:"text-lg text-white/80 hover:text-white hover:bg-white/10 rounded-full px-8 py-4 bg-white/10 border border-white/20",disabled:F,children:"recent"===H?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{className:"mr-1 h-6 w-6"}),"Недавние"]}):"favorites"===H?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{className:"mr-1 h-6 w-6"}),"Избранное"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.A,{className:"mr-1 h-6 w-6"}),"Плейлисты"]})})})]})]})})}),(0,s.jsx)("div",{className:"hidden md:block mb-8",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-card/10 backdrop-blur-sm rounded-2xl p-6 border border-border/30",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-primary/20 rounded-lg flex items-center justify-center",children:(0,s.jsx)(o.A,{className:"w-5 h-5 text-primary"})}),(0,s.jsx)("h2",{className:"text-lg font-bold text-foreground",children:"Избранное"})]}),eU.length>0&&(0,s.jsxs)(V,{variant:"ghost",size:"sm",onClick:()=>{ew(),eN(eU),eb(eU[0])},className:"text-primary hover:text-primary hover:bg-primary/10 rounded-full px-3 py-1",children:[(0,s.jsx)(n.A,{className:"w-4 h-4 mr-1"}),"Play"]})]}),eU.length>0?(0,s.jsx)("div",{className:"flex gap-3 overflow-x-auto pb-2",children:eU.slice(0,4).map(e=>(0,s.jsxs)("div",{className:"flex-shrink-0 w-24 text-center",onClick:()=>e4(e),children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-muted rounded-xl flex items-center justify-center overflow-hidden mb-2 mx-auto hover:scale-105 transition-transform cursor-pointer border border-border",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover rounded-xl"}):(0,s.jsx)(d.A,{className:"w-8 h-8 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-foreground text-xs font-medium truncate",children:e.title}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs truncate",children:e.artist})]})]},e.id))}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(o.A,{className:"w-12 h-12 text-muted-foreground/30 mx-auto mb-3"}),(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:"Нет избранных треков"}),(0,s.jsx)("p",{className:"text-muted-foreground/60 text-xs mt-1",children:"Добавьте треки в избранное"})]})]}),(0,s.jsxs)("div",{className:"bg-card/10 backdrop-blur-sm rounded-2xl p-6 border border-border/30",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-primary/20 rounded-lg flex items-center justify-center",children:(0,s.jsx)(c.A,{className:"w-5 h-5 text-primary"})}),(0,s.jsx)("h2",{className:"text-lg font-bold text-foreground",children:"Плейлисты"})]}),e_.length>0?(0,s.jsx)("div",{className:"flex gap-3 overflow-x-auto pb-2",children:e_.slice(0,4).map(e=>(0,s.jsxs)("div",{className:"flex-shrink-0 w-24 text-center",onClick:async()=>{e.tracks&&e.tracks.length>0&&(ew(),eN(e.tracks),await eb(e.tracks[0],!0))},children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-muted rounded-xl flex items-center justify-center overflow-hidden mb-2 mx-auto hover:scale-105 transition-transform cursor-pointer border border-border",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover rounded-xl"}):(0,s.jsx)(d.A,{className:"w-8 h-8 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-foreground text-xs font-medium truncate",children:e.title}),(0,s.jsxs)("p",{className:"text-muted-foreground text-xs truncate",children:[e.trackCount||0," треков"]})]})]},e.id))}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(c.A,{className:"w-12 h-12 text-muted-foreground/30 mx-auto mb-3"}),(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:"Нет плейлистов"}),(0,s.jsx)("p",{className:"text-muted-foreground/60 text-xs mt-1",children:"Создайте свой первый плейлист"})]})]})]})}),(0,s.jsx)("div",{className:"hidden md:block mb-8",children:(0,s.jsxs)("div",{className:"bg-card/10 backdrop-blur-sm rounded-2xl p-6 border border-border/30",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-primary/20 rounded-lg flex items-center justify-center",children:(0,s.jsx)(i.A,{className:"w-5 h-5 text-primary"})}),(0,s.jsx)("h2",{className:"text-lg font-bold text-foreground",children:"Недавно прослушано"})]}),eF.length>0?(0,s.jsx)("div",{className:"flex gap-3 overflow-x-auto pb-2",children:eF.slice(0,12).map(e=>(0,s.jsxs)("div",{className:"flex-shrink-0 w-24 text-center",onClick:()=>e4(e),children:[(0,s.jsx)("div",{className:"w-20 h-20 bg-white/10 rounded-xl flex items-center justify-center overflow-hidden mb-2 mx-auto hover:scale-105 transition-transform cursor-pointer border border-white/20",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover rounded-xl"}):(0,s.jsx)(d.A,{className:"w-8 h-8 text-white/40"})}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-white text-xs font-medium truncate",children:e.title}),(0,s.jsx)("p",{className:"text-white/60 text-xs truncate",children:e.artist})]})]},e.id))}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full min-h-[200px]",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-white/10 rounded-full flex items-center justify-center mb-4 backdrop-blur-sm border border-white/20",children:(0,s.jsx)(i.A,{className:"w-8 h-8 text-white/40"})}),(0,s.jsx)("p",{className:"text-white/60 text-lg",children:"Нет недавних треков"})]})]})}),(0,s.jsxs)("div",{className:"md:hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(h,{size:32,className:"opacity-90"}),(0,s.jsx)("h1",{className:"text-3xl md:text-4xl font-bold",children:"Dotify"}),(0,s.jsx)(ti,{isMobile:!0})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(V,{variant:"ghost",size:"sm",className:"text-white/60 hover:text-white hover:bg-white/10 rounded-full p-2",onClick:()=>q(!0),children:(0,s.jsx)(i.A,{className:"w-5 h-5"})}),(0,s.jsx)(tt,{isMobile:!0})]})]}),(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"relative h-48 flex flex-col items-center justify-center rounded-3xl bg-gradient-to-br from-primary/10 to-primary/5 overflow-hidden border border-primary/20",children:[(0,s.jsxs)("div",{className:"absolute inset-0 pointer-events-none z-0",children:[(0,s.jsx)("div",{className:"absolute -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2 w-32 h-32 bg-primary/30 rounded-full blur-3xl opacity-50 animate-pulse"}),(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 w-24 h-24 -translate-x-1/4 -translate-y-1/4 bg-primary/20 rounded-full blur-2xl opacity-40 animate-pulse",style:{animationDelay:"1s"}})]}),(0,s.jsxs)("div",{className:"text-center flex flex-col items-center justify-center w-full p-6 z-10",children:[(0,s.jsxs)("button",{onClick:e3,disabled:F,className:"group flex flex-col items-center gap-4 text-white transition-all duration-300 ease-in-out hover:scale-105 disabled:cursor-not-allowed",children:[F?(0,s.jsx)("div",{className:"h-16 w-16 rounded-full bg-primary/20 flex items-center justify-center",children:(0,s.jsx)(l.A,{className:"animate-spin h-8 w-8 text-primary"})}):(0,s.jsx)("div",{className:"h-16 w-16 rounded-full bg-primary/20 border border-primary/30 flex items-center justify-center transition-all duration-300 group-hover:bg-primary/30",children:(0,s.jsx)(n.A,{className:"h-8 w-8 text-primary ml-1"})}),(0,s.jsx)("span",{className:"text-2xl font-bold text-center w-full text-foreground",children:"Моя волна"})]}),(0,s.jsx)("div",{className:"mt-4 flex items-center gap-2",children:(0,s.jsx)(V,{variant:"ghost",size:"sm",onClick:()=>{let e=["recent","favorites","playlists"],t=(e.indexOf(H)+1)%e.length;W(e[t])},className:"text-sm text-primary/80 hover:text-primary hover:bg-primary/10 rounded-full px-6 py-3 bg-primary/10 border border-primary/20",disabled:F,children:"recent"===H?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.A,{className:"mr-2 h-4 w-4"}),"Недавние"]}):"favorites"===H?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Избранное"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"Плейлисты"]})})})]})]})})]}),(0,s.jsxs)("div",{className:"md:hidden space-y-8 overflow-y-auto flex-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Избранное"}),eU.length>0&&(0,s.jsxs)(V,{variant:"ghost",size:"sm",onClick:()=>{ew(),eN(eU),eb(eU[0])},className:"text-primary hover:text-primary hover:bg-primary/10 rounded-full px-3 py-1",children:[(0,s.jsx)(n.A,{className:"w-4 h-4 mr-1"}),"Play"]})]}),eU.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 gap-3",children:eU.slice(0,6).map(e=>(0,s.jsx)("div",{className:"bg-white/5 rounded-xl p-4 hover:bg-white/10 transition-colors cursor-pointer",onClick:()=>e4(e),children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"w-14 h-14 bg-white/10 rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover"}):(0,s.jsx)(d.A,{className:"w-7 h-7 text-white/40"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-white text-base font-medium truncate",children:e.title}),(0,s.jsx)("p",{className:"text-white/60 text-sm truncate",children:e.artist})]})]})},e.id))}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(o.A,{className:"w-16 h-16 text-white/20 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-white/60 text-lg",children:"Нет избранных треков"}),(0,s.jsx)("p",{className:"text-white/40 text-sm mt-2",children:"Добавьте треки в избранное, чтобы увидеть их здесь"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Плейлисты"})}),e_.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 gap-3",children:e_.slice(0,6).map(e=>(0,s.jsx)("div",{className:"bg-white/5 rounded-xl p-4 hover:bg-white/10 transition-colors cursor-pointer",onClick:()=>e1(e),children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"w-14 h-14 bg-white/10 rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover"}):(0,s.jsx)(d.A,{className:"w-7 h-7 text-white/40"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-white text-base font-medium truncate",children:e.title}),(0,s.jsxs)("p",{className:"text-white/60 text-sm truncate",children:[e.trackCount||0," треков"]})]})]})},e.id))}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(c.A,{className:"w-16 h-16 text-white/20 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-white/60 text-lg",children:"Нет плейлистов"}),(0,s.jsx)("p",{className:"text-white/40 text-sm mt-2",children:"Создайте свой первый плейлист"})]})]})]})]}),"search"===x&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(E,{searchQuery:j,onSearchChange:y,onClear:()=>A({tracks:[],playlists:[]}),hasResults:e8,searchType:P,onSearchTypeChange:z,platform:L,onPlatformChange:M,isSearching:C})}),j&&(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,s.jsx)(eI,{tracks:k.tracks,playlists:k.playlists,searchQuery:j,onTrackSelect:e0,onPlaylistSelect:e1,onAddToPlaylist:e=>{$(e),Y(!0)},onDownloadTrack:async e=>{try{await tk.Q.downloadTrack(e)}catch(e){console.error("Ошибка при скачивании:",e),eO.error("Ошибка при скачивании: "+(e instanceof Error?e.message:"Неизвестная ошибка"))}},onShareTrack:e=>{var t;let r="".concat(e.title," - ").concat(e.artist);if(null===(t=window.Telegram)||void 0===t?void 0:t.WebApp)try{let e=window.Telegram.WebApp;if(e.switchInlineQuery&&"function"==typeof e.switchInlineQuery){console.log("Using switchInlineQuery with query:",r),e.switchInlineQuery(r,["users","groups","channels"]);return}if(console.log("switchInlineQuery not available, trying openTelegramLink"),e.openTelegramLink&&"function"==typeof e.openTelegramLink){let t="https://t.me/nodotify_bot?startapp=".concat(encodeURIComponent(r));console.log("Using openTelegramLink with startapp URL:",t),e.openTelegramLink(t);return}if(e.openLink&&"function"==typeof e.openLink){let t="https://t.me/nodotify_bot?startapp=".concat(encodeURIComponent(r));console.log("Using openLink with startapp URL:",t),e.openLink(t);return}let t="https://t.me/nodotify_bot?startapp=".concat(encodeURIComponent(r));console.log("Using fallback URL:",t),window.open(t,"_blank")}catch(t){console.log("Telegram WebApp methods not available, using fallback:",t);let e="https://t.me/nodotify_bot?startapp=".concat(encodeURIComponent(r));window.open(e,"_blank")}else{let e="https://t.me/nodotify_bot?startapp=".concat(encodeURIComponent(r));window.open(e,"_blank")}},isLoading:C,searchType:P})})]}),"library"===x&&(0,s.jsx)(tA,{onTrackSelect:e4,onPlaylistSelect:e=>{w(e)},currentTrack:ei,isPlaying:eo,currentPlaylist:N,onToggleShuffle:eS}),"player"===x&&ei&&(0,s.jsx)(eB,{track:ei,nextTrack:"repeat"===ex?null:eP(),isPlaying:eo,isLoading:ec,currentTime:ed,duration:em,volume:eu,repeatMode:ex,shuffle:ep,onPlayPause:ev,onNext:ej,onPrevious:ey,onSeek:ek,onVolumeChange:eA,onRepeatToggle:eC,onShuffleToggle:eS,onBack:()=>{p?(f(p),g(null)):f("home"),D(!1)},onToggleLike:()=>eH(ei),isLiked:eU.some(e=>e.id===ei.id),onAddToPlaylist:()=>{$(ei),Y(!0)}}),"playlist"===x&&N&&(0,s.jsx)(eK,{playlist:N,currentTrack:ei,onTrackSelect:e0,onBack:()=>{p?(f(p),g(null)):(f("home"),v("home"))},shuffle:ep,onShuffleToggle:eS,isLoading:T,onDeletePlaylist:async e=>{try{eX(e),(null==N?void 0:N.id)===e&&(w(null),f("library"))}catch(e){console.error("Ошибка при удалении плейлиста:",e)}},onUpdatePlaylist:async(e,t)=>{try{eY(e,t),(null==N?void 0:N.id)===e&&w(e=>e?{...e,...t}:null)}catch(e){console.error("Ошибка при обновлении плейлиста:",e)}},onToggleFavorite:eH,onAddToPlaylist:(e,t)=>{},onDownloadTrack:async e=>{try{var t;let r=null==N?void 0:null===(t=N.tracks)||void 0===t?void 0:t.find(t=>t.id===e);if(!r){console.error("Трек не найден:",e);return}await tk.Q.downloadTrack(r)}catch(e){console.error("Ошибка при скачивании:",e),eO.error("Ошибка при скачивании: "+(e instanceof Error?e.message:"Неизвестная ошибка"))}},favorites:eU})]})}),ei&&"player"!==x&&(0,s.jsx)(eQ,{track:ei,isPlaying:eo,onPlayPause:ev,onExpand:()=>{g(x),f("player"),D(!0)},onNext:ej,onPrevious:ey,volume:eu,onVolumeChange:eA,isSidebarCollapsed:U,onToggleLike:()=>eH(ei),isLiked:eU.some(e=>e.id===ei.id),onShuffle:eS,onRepeat:eC,isShuffled:ep,repeatMode:"repeat"===ex?"queue":ex,onAddToPlaylist:()=>{$(ei),Y(!0)},currentTime:ed,duration:em,onSeek:ek}),!R&&(0,s.jsx)(to,{activeTab:b,onTabChange:e2}),(0,s.jsx)(Z,{open:K,onOpenChange:q,children:(0,s.jsxs)(er,{className:"bg-background/95 border-border h-3/4",children:[(0,s.jsx)(es,{children:(0,s.jsx)(ea,{className:"text-foreground",children:"Недавно прослушано"})}),(0,s.jsx)("div",{className:"px-4 pb-20",children:(0,s.jsx)(I,{className:"h-[calc(100vh-200px)]",children:0===eF.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(i.A,{className:"w-12 h-12 text-white/20 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-white/60",children:"Нет недавних треков"}),(0,s.jsx)("p",{className:"text-white/40 text-sm mt-1",children:"Воспроизведите треки, чтобы увидеть их здесь"})]}):(0,s.jsx)("div",{className:"space-y-2",children:eF.map((e,t)=>(0,s.jsxs)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"flex items-center p-3 rounded-lg hover:bg-white/5 transition-colors cursor-pointer",onClick:()=>{e4(e),q(!1)},children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-white/10 rounded-lg flex items-center justify-center mr-3 flex-shrink-0 overflow-hidden",children:e.coverArt?(0,s.jsx)("img",{src:e.coverArt,alt:e.title,className:"w-full h-full object-cover"}):(0,s.jsx)(d.A,{className:"w-5 h-5 text-white/40"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-white text-sm font-medium truncate",children:e.title}),(0,s.jsx)("p",{className:"text-white/60 text-xs truncate",children:e.artist})]}),(0,s.jsx)(V,{variant:"ghost",size:"icon",className:"text-white/60 hover:text-white hover:bg-white/10 rounded-full w-8 h-8",onClick:t=>{t.stopPropagation(),eH(e.id)},children:(0,s.jsx)(o.A,{className:"w-4 h-4 ".concat(eU.some(t=>t.id===e.id)?"text-red-500 fill-red-500":"")})})]},e.id))})})})]})}),X&&G&&(0,s.jsx)(ef,{track:G,isMobile:!1,open:X,onOpenChange:Y}),(0,s.jsx)(u.N,{children:Q&&(0,s.jsxs)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center z-50 bg-background/80 backdrop-blur-sm overflow-hidden",children:[(0,s.jsxs)("div",{className:"absolute inset-0 pointer-events-none z-0",children:[(0,s.jsx)("div",{className:"absolute left-1/2 top-1/2 w-96 h-96 -translate-x-1/2 -translate-y-1/2 rounded-full bg-primary/30 blur-3xl opacity-40 animate-pulse"}),(0,s.jsx)("div",{className:"absolute left-1/3 top-1/3 w-64 h-64 -translate-x-1/2 -translate-y-1/2 rounded-full bg-primary/20 blur-2xl opacity-30 animate-pulse",style:{animationDelay:"1s"}}),(0,s.jsx)("div",{className:"absolute right-1/4 bottom-1/3 w-32 h-32 rounded-full bg-white/10 blur-2xl opacity-20 animate-pulse",style:{animationDelay:"2s"}})]}),(0,s.jsx)("div",{className:"relative z-10 flex flex-col items-center justify-center px-4 py-8",children:(0,s.jsxs)("div",{className:"flex items-end justify-center gap-1 h-10 mb-2",children:[(0,s.jsx)("div",{className:"w-2 h-6 rounded-full bg-primary animate-pulse opacity-80",style:{animationDelay:"0s"}}),(0,s.jsx)("div",{className:"w-2 h-8 rounded-full bg-primary animate-pulse opacity-60",style:{animationDelay:"0.1s"}}),(0,s.jsx)("div",{className:"w-2 h-10 rounded-full bg-primary animate-pulse opacity-100",style:{animationDelay:"0.2s"}}),(0,s.jsx)("div",{className:"w-2 h-8 rounded-full bg-primary animate-pulse opacity-60",style:{animationDelay:"0.3s"}}),(0,s.jsx)("div",{className:"w-2 h-6 rounded-full bg-primary animate-pulse opacity-80",style:{animationDelay:"0.4s"}})]})})]})}),(0,s.jsx)(tC,{})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[629,846,76,881,724,779,501,432,979,899,744,33,322,592,940,652,494,30,719,514,304,558,473,219,358],()=>t(79461)),_N_E=e.O()}]);